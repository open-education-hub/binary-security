<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Binary Analysis/Exploration Tools/Reading/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Exploration Tools | Binary Security</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://open-education-hub.github.io/binary-security/Binary Analysis/Exploration Tools/Reading/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Exploration Tools | Binary Security"><meta data-rh="true" name="description" content="Tutorials"><meta data-rh="true" property="og:description" content="Tutorials"><link data-rh="true" rel="canonical" href="http://open-education-hub.github.io/binary-security/Binary Analysis/Exploration Tools/Reading/"><link data-rh="true" rel="alternate" href="http://open-education-hub.github.io/binary-security/Binary Analysis/Exploration Tools/Reading/" hreflang="en"><link data-rh="true" rel="alternate" href="http://open-education-hub.github.io/binary-security/Binary Analysis/Exploration Tools/Reading/" hreflang="x-default"><link rel="stylesheet" href="/binary-security/assets/css/styles.a69a9d41.css">
<link rel="preload" href="/binary-security/assets/js/runtime~main.74200969.js" as="script">
<link rel="preload" href="/binary-security/assets/js/main.d9be8505.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/binary-security/"><div class="navbar__logo"><img src="/binary-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/binary-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Binary Security</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/binary-security/Binary Analysis">Binary Analysis</a><a class="navbar__item navbar__link" href="/binary-security/Exploitation Techniques">Exploitation Techniques</a><a class="navbar__item navbar__link" href="/binary-security/Mitigation and Defensive Strategies">Mitigation and Defensive Strategies</a><a class="navbar__item navbar__link" href="/binary-security/Extra">Extra</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/binary-security/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/binary-security/Binary Analysis/">Binary Analysis</a><button aria-label="Toggle the collapsible sidebar category &#x27;Binary Analysis&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/binary-security/Binary Analysis/Exploration Tools/">Exploration Tools</a><button aria-label="Toggle the collapsible sidebar category &#x27;Exploration Tools&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/binary-security/Binary Analysis/Exploration Tools/Reading/">Reading</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/binary-security/Binary Analysis/Exploration Tools/Exploration-Tools">Slides</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/binary-security/Binary Analysis/Executables and Processes/">Executables and Processes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Executables and Processes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/binary-security/Binary Analysis/Static Analysis/">Static Analysis</a><button aria-label="Toggle the collapsible sidebar category &#x27;Static Analysis&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/binary-security/Binary Analysis/Dynamic Analysis/">Dynamic Analysis</a><button aria-label="Toggle the collapsible sidebar category &#x27;Dynamic Analysis&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/binary-security/Exploitation Techniques/">Exploitation Techniques</a><button aria-label="Toggle the collapsible sidebar category &#x27;Exploitation Techniques&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/binary-security/Mitigation and Defensive Strategies/">Mitigation and Defensive Strategies</a><button aria-label="Toggle the collapsible sidebar category &#x27;Mitigation and Defensive Strategies&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/binary-security/Extra/">Extra</a><button aria-label="Toggle the collapsible sidebar category &#x27;Extra&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/binary-security/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/binary-security/Binary Analysis/"><span itemprop="name">Binary Analysis</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/binary-security/Binary Analysis/Exploration Tools/"><span itemprop="name">Exploration Tools</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Reading</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Exploration Tools</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tutorials">Tutorials<a class="hash-link" href="#tutorials" title="Direct link to heading">​</a></h2><p>When faced with a binary with no source or parts of the source missing you can infer some of its functionalities based upon some basic reconnaissance techniques using various tools.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="01-tutorial---poor-mans-technique-strings">01. Tutorial - Poor Man&#x27;s Technique: <code>strings</code><a class="hash-link" href="#01-tutorial---poor-mans-technique-strings" title="Direct link to heading">​</a></h3><p>The simplest recon technique is to dump the ASCII (or Unicode) text from a binary.
It doesn&#x27;t offer any guarantees but sometimes you can get a lot of useful information out of it.</p><p>By default, when applied to a binary it only scans the data section.
To obtain information such as the compiler version used in producing the binary use:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">strings -a crackme1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s illustrate how <code>strings</code> can be useful in a simple context.
Try out the <a href="/binary-security/Binary Analysis/Exploration Tools/Reading/activities/01-tutorial-strings/src"><code>crackme1</code></a> binary:</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;string.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">my_strcmp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">s1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">s2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">size_t</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> len </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">strlen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">len </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> len</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s1</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> s2</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> buf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Password:\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">fgets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">stdin</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    buf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token function" style="color:#d73a49">strlen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token char">&#x27;\0&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token function" style="color:#d73a49">my_strcmp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Correct!\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Nope!\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The password has been redacted from the listing but you can retrieve it with <code>strings</code>.
Try it out!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="02-tutorial---execution-tracing-ltrace-and-strace">02. Tutorial - Execution Tracing (<code>ltrace</code> and <code>strace</code>)<a class="hash-link" href="#02-tutorial---execution-tracing-ltrace-and-strace" title="Direct link to heading">​</a></h3><p><a href="https://man7.org/linux/man-pages/man1/ltrace.1.html" target="_blank" rel="noopener noreferrer"><code>ltrace</code></a> is an utility that can list library function calls or <a href="https://man7.org/linux/man-pages/man2/syscalls.2.html" target="_blank" rel="noopener noreferrer">syscalls</a> made by a program.
<a href="https://man7.org/linux/man-pages/man1/strace.1.html" target="_blank" rel="noopener noreferrer"><code>strace</code></a> is similar, but only lists syscalls.
A syscall is a service exposed by the kernel itself.</p><p>The way they work is with the aid of a special syscall, called <a href="https://man7.org/linux/man-pages/man2/ptrace.2.html" target="_blank" rel="noopener noreferrer"><code>ptrace</code></a>.
This single syscall forms the basis for most of the functionality provided by <code>ltrace</code>, <code>strace</code>, <code>gdb</code> and similar tools that debug programs.
It can receive up to 4 arguments: the operation, the PID to act on, the address to read/write and the data to write.
The functionality exposed by <code>ptrace()</code> is massive, but think of any functionality you&#x27;ve seen in a debugger:</p><ul><li>attach/detach to/from a process</li><li>set breakpoints</li><li>continue a stopped program</li><li>read/write registers</li><li>act on signals</li><li>register syscalls</li></ul><p><code>strace</code> provides some pretty printing strictly concerning the syscalls of the traced process.
However, <code>ltrace</code> provides further functionality and gathers information about all library calls.
Here&#x27;s how <code>ltrace</code> does its magic:</p><ul><li>it reads the <code>tracee</code> memory and parses it in order to find out about loaded symbols</li><li>it makes a copy of the binary code pertaining to a symbol using a <code>PTRACE_PEEKTEXT</code> directive of <code>ptrace()</code></li><li>it injects a breakpoint using a <code>PTRACE_POKETEXT</code> directive of <code>ptrace()</code></li><li>it listens for a <code>SIGTRAP</code> which will be generated when the breakpoint is hit</li><li>when the breakpoint is hit, ltrace can examine the stack of the <code>tracee</code> and print information such as function name, parameters, return codes, etc.</li></ul><p>Let&#x27;s try the next <code>crackme</code>.
If we remove <code>my_strcmp</code> from the previous <code>crackme</code> you can solve it even without <code>strings</code> because <code>strcmp</code> is called from <code>libc.so</code>.
You can use <code>ltrace</code> and see what functions are used and check for their given parameters.
Try it out on the second <code>crackme</code> where <code>strings</code> does not help (<a href="/binary-security/Binary Analysis/Exploration Tools/Reading/activities/02-tutorial-execution-tracing/src"><code>crackme2</code></a>):</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;string.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> correct_pass</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token function" style="color:#d73a49">deobf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> buf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Password:\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">fgets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">stdin</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    buf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token function" style="color:#d73a49">strlen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token char">&#x27;\0&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token function" style="color:#d73a49">strcmp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">deobf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">correct_pass</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Correct!\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Nope!\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="03-tutorial---symbols-nm">03. Tutorial - Symbols: <code>nm</code><a class="hash-link" href="#03-tutorial---symbols-nm" title="Direct link to heading">​</a></h3><p>Symbols are basically tags/labels, either for functions or for variables.
If you enable debugging symbols you will get information on all the variables defined but normally symbols are only defined for functions and global variables.
When stripping binaries even these can be deleted without any effect on the binary behavior.
Dynamic symbols, however, have to remain so that the linker knows what functions to import:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ file xy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xy: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.16, not stripped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ nm xy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0804a020 B __bss_start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0804a018 D __data_start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0804a018 W data_start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0804a01c D __dso_handle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">08049f0c d _DYNAMIC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0804a020 D _edata</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0804a024 B _end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">080484e4 T _fini</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">080484f8 R _fp_hw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0804a000 d _GLOBAL_OFFSET_TABLE_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         w __gmon_start__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">080482d4 T _init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">08049f04 t __init_array_end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">08049f00 t __init_array_start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">080484fc R _IO_stdin_used</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         w _ITM_deregisterTMCloneTable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         w _ITM_registerTMCloneTable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         w _Jv_RegisterClasses</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">080484e0 T __libc_csu_fini</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">08048470 T __libc_csu_init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         U __libc_start_main@@GLIBC_2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0804843c T main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         U puts@@GLIBC_2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">08048340 T _start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0804a020 D __TMC_END__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">08048370 T __x86.get_pc_thunk.bx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ strip xy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ nm xy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nm: xy: no symbols</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ nm -D xy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         w __gmon_start__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">080484fc R _IO_stdin_used</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         U __libc_start_main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         U puts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s take a look at another <code>crackme</code> that combines <code>crackme1</code> and <code>crackme2</code>.
What would you do if you couldn&#x27;t use neither strings nor ltrace to get anything useful?</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;string.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> correct_pass</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">my_strcmp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">s1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">s2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">size_t</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> len </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">strlen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">len </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> len</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s1</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> s2</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token function" style="color:#d73a49">deobf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> buf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">deobf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">correct_pass</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Password:\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">fgets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">stdin</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    buf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token function" style="color:#d73a49">strlen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token char">&#x27;\0&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token function" style="color:#d73a49">my_strcmp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> correct_pass</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Correct!\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Nope!\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In <a href="/binary-security/Binary Analysis/Exploration Tools/Reading/activities/03-tutorial-symbols/src"><code>crackme3</code></a>, deobfuscation is done before the password is read.
Since the <code>correct_pass</code> has an associated symbol that is stored at a known location you can obtain the address and peer into it at runtime:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ nm crackme3 | grep pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0804a02c D correct_pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ gdb -n ./crackme3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Reading symbols from ./crackme3...(no debugging symbols found)...done.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Password:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">^C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Program received signal SIGINT, Interrupt.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xf7fdb430 in __kernel_vsyscall ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) x/s 0x0804a02c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x804a02c &lt;correct_pass&gt;:    &quot;JWxb7gE2pjiY3gRG8U&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The above <code>x/s 0x0804a02c</code> command in GDB is used for printing the string starting from address <code>0x0804a02c</code>.
<code>x</code> stands for examine memory and <code>s</code> stands for string format.
In short it dumps memory in string format starting from the address passed as argument.
You may print multiple strings by prefixing <code>s</code> with a number, for example <code>x/20s 0x0804a02c</code>.</p><p>For other programs (that are not stripped) you can even get a hint as to what they do using solely <code>nm</code>:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ nm mystery_binary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.....</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000000402bef T drop_privs(char const*)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00000000004027db T IndexHandler(std::string const&amp;, HttpRequest const&amp;, HttpResponse*)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000000402ad8 T StatusHandler(std::string const&amp;, HttpRequest const&amp;, HttpResponse*)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">000000000040237f T NotFoundHandler(std::string const&amp;, HttpRequest const&amp;, HttpResponse*)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00000000004024a1 T BadRequestHandler(std::string const&amp;, HttpRequest const&amp;, HttpResponse*)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00000000004025c3 T MaybeAddCORSHeader(std::string const&amp;, HttpRequest const&amp;, HttpResponse*)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000000402f52 t __static_initialization_and_destruction_0(int, int)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000000402cf8 T handle(int)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00000000004020fc T recvlen(int, char*, unsigned long)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000000402195 T sendlen(int, char const*, unsigned long)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000000402224 T sendstr(int, char const*)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000000402255 T urldecode(std::string const&amp;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.....</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Note:</strong> In this case the signatures are also decoded because the binary was compiled from C++ source code.</p><p>Dealing with stripped binaries (or worse, statically linked binaries that have been stripped) is harder but can still be done.
We&#x27;ll see how in a future lab.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="04-tutorial---library-dependencies">04. Tutorial - Library Dependencies<a class="hash-link" href="#04-tutorial---library-dependencies" title="Direct link to heading">​</a></h3><p>Most programs you will see make use of existing functionality.
You don&#x27;t want to always reimplement string functions or file functions.
Therefore, most programs use dynamic libraries.
These shared objects, as they are called alternatively, allow you to have a smaller program and also allow multiple programs to use a single copy of the code within the library.
But how does that actually work?</p><p>What makes all of these programs work is the Linux dynamic linker/loader.
This is a statically linked helper program that resolves symbol names from shared objects at runtime.
We can use the dynamic linker to gather information about an executable.</p><p>The first and most common thing to do is see what libraries the executable loads, with the <a href="https://man7.org/linux/man-pages/man1/ldd.1.html" target="_blank" rel="noopener noreferrer"><code>ldd</code></a> utility:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ldd /bin/ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    linux-vdso.so.1 (0x00007ffff13fe000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    librt.so.1 =&gt; /lib64/librt.so.1 (0x00007fc9b4893000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    libacl.so.1 =&gt; /lib64/libacl.so.1 (0x00007fc9b468a000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    libc.so.6 =&gt; /lib64/libc.so.6 (0x00007fc9b42da000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00007fc9b40bd000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    libattr.so.1 =&gt; /lib64/libattr.so.1 (0x00007fc9b3eb8000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /lib64/ld-linux-x86-64.so.2 (0x00007fc9b4a9b000)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We see that for each dependency in the executable, <code>ldd</code> lists where it is found on the filesystem and where it is loaded in the process memory space.
Alternatively, you can achieve the same result with the <code>LD_TRACE_LOADED_OBJECTS</code> environment variable, or with the dynamic loader itself:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ LD_TRACE_LOADED_OBJECTS=whatever /bin/ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    linux-vdso.so.1 (0x00007fff325fe000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    librt.so.1 =&gt; /lib64/librt.so.1 (0x00007f1845386000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    libacl.so.1 =&gt; /lib64/libacl.so.1 (0x00007f184517d000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f1844dcd000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00007f1844bb0000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    libattr.so.1 =&gt; /lib64/libattr.so.1 (0x00007f18449ab000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /lib64/ld-linux-x86-64.so.2 (0x00007f184558e000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ /lib/ld-linux-x86-64.so.2 --list /bin/ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    linux-vdso.so.1 (0x00007fff1e712000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    librt.so.1 =&gt; /lib64/librt.so.1 (0x00007f18a07d8000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    libacl.so.1 =&gt; /lib64/libacl.so.1 (0x00007f18a05cf000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f18a021e000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    libattr.so.1 =&gt; /lib64/libattr.so.1 (0x00007f189fdfc000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00007f18a0001000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /lib64/ld-linux-x86-64.so.2 =&gt; /lib/ld-linux-x86-64.so.2 (0x00007f18a0c44000)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When using the loader directly, make sure the loader and the executable are compiled for the same platform (e.g.  they are both 64-bit or 32-bit).
You may find out more information about dynamic linker/loader variables in its man page.
Issue the command:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">man ld-linux.so</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>and search for the <code>LD_</code> string to find variables information.</p><p><code>ldd</code> shows us <strong>which</strong> libraries are loaded, but it&#x27;s not any clearer how the loader knows <strong>where</strong> to load them from.
First of all, the loader checks every dependency for a slash character.
If it finds such a dependency it loads the library from that path, whether it is a relative of absolute path.
But it is not the case in our example.
For dependencies without slashes, the search order is as follows:</p><ul><li><code>DT_RPATH</code> attribute in the <code>.dynamic</code> section of the executable, provided there is no <code>DT_RUNPATH</code>; this is deprecated</li><li><code>LD_LIBRARY_PATH</code> environment variable, which is similar to <code>PATH</code>; does not work with <code>setuid</code> / <code>setgid</code> programs</li><li><code>DT_RUNPATH</code> attribute in the <code>.dynamic</code> section of the executable</li><li><code>/etc/ld.so.cache</code>, generated by <a href="https://man7.org/linux/man-pages/man8/ldconfig.8.html" target="_blank" rel="noopener noreferrer"><code>ldconfig</code></a></li><li><code>/lib</code> and then <code>/usr/lib</code></li></ul><p>The last two options are skipped if the program was linked with the <code>-z nodeflib</code> option.</p><p>Now let&#x27;s see exactly where the loader finds the libraries:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ LD_DEBUG=libs /bin/ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:    find library=librt.so.1 [0]; searching</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:     search cache=/etc/ld.so.cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:      trying file=/lib64/librt.so.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:    find library=libacl.so.1 [0]; searching</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:     search cache=/etc/ld.so.cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:      trying file=/lib64/libacl.so.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:    find library=libc.so.6 [0]; searching</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:     search cache=/etc/ld.so.cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:      trying file=/lib64/libc.so.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:    find library=libpthread.so.0 [0]; searching</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:     search cache=/etc/ld.so.cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:      trying file=/lib64/libpthread.so.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:    find library=libattr.so.1 [0]; searching</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:     search cache=/etc/ld.so.cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11451:      trying file=/lib64/libattr.so.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>LD_DEBUG</code> environment variable makes the dynamic loader be verbose about what it&#x27;s doing.
Try <code>LD_DEBUG=help</code> if you&#x27;re curious about what else you can find out.
We can see in the output listed above that all the libraries are found via the loader cache.
The number at the beginning of each line is the PID of the <code>ls</code> process.</p><p>And now we can discuss <strong>how</strong> the loader resolves symbols after it has found the libraries containing them.
While variables are resolved when the library is opened, that is not the case for function references.
When dealing with functions, the Linux dynamic loader uses something called lazy binding, which means that a function symbol in the library is not resolved until the very first call to it.
Think about why this difference exists.</p><p>You can see the way lazy binding behaves:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ LD_DEBUG=symbols,bindings ./crackme2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:    initialize program: ./crackme2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:    transferring control: ./crackme2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:    symbol=puts;  lookup in file=./crackme2 [0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:    symbol=puts;  lookup in file=/lib32/libc.so.6 [0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:    binding file ./crackme2 [0] to /lib32/libc.so.6 [0]: normal symbol &#x27;puts&#x27; [GLIBC_2.0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Password:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:    symbol=fgets;  lookup in file=./crackme2 [0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:    symbol=fgets;  lookup in file=/lib32/libc.so.6 [0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:    binding file ./crackme2 [0] to /lib32/libc.so.6 [0]: normal symbol &#x27;fgets&#x27; [GLIBC_2.0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I_pity_da_fool_who_gets_here_without_solving_crackme2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:    symbol=strlen;  lookup in file=./crackme2 [0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:    symbol=strlen;  lookup in file=/lib32/libc.so.6 [0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:    binding file ./crackme2 [0] to /lib32/libc.so.6 [0]: normal symbol &#x27;strlen&#x27; [GLIBC_2.0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:    symbol=strcmp;  lookup in file=./crackme2 [0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:    symbol=strcmp;  lookup in file=/lib32/libc.so.6 [0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:    binding file ./crackme2 [0] to /lib32/libc.so.6 [0]: normal symbol &#x27;strcmp&#x27; [GLIBC_2.0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nope!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:    calling fini: ./crackme2 [0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     11480:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As you can see, functions like <code>puts()</code>, <code>fgets()</code>, <code>strlen()</code> and <code>strcmp()</code> are not actually resolved until the first call to them is made.
Make the loader resolve all the symbols at startup.
(Hint: <a href="https://man7.org/linux/man-pages/man8/ld-linux.8.html" target="_blank" rel="noopener noreferrer">ld-linux</a>).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="library-wrapper-task">Library Wrapper Task<a class="hash-link" href="#library-wrapper-task" title="Direct link to heading">​</a></h4><p>You&#x27;ve previously solved <code>crackme2</code> with the help of the <code>ltrace</code>.
Check out the files from <a href="/binary-security/Binary Analysis/Exploration Tools/Reading/activities/04-tutorial-library-dependencies/src">04-tutorial-library-dependencies</a>.
The folder consists of a <code>Makefile</code> and a C source code file reimplementing the <code>strcmp()</code> function (library wrapper).
The <code>strcmp.c</code> implementation uses <code>LD_PRELOAD</code> to wrap the actual <code>strcmp()</code> call to our own.</p><p>In order to see how that works, we need to create a shared library and pass it as an argument to <code>LD_PRELOAD</code>.
The <code>Makefile</code> already takes care of this.
To build and run the entire thing, simply run:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will build the shared library file (<code>strcmp.so</code>) and run the <code>crackme2</code> executable under <code>LD_PRELOAD</code>.</p><p>Our goal is to use the <code>strcmp()</code> wrapper to alter the program behavior.
We have two ways to make the <code>crackme2</code> program behave our way:</p><ol><li>Leak the password in the <code>strcmp()</code> wrapper.</li><li>Pass the check regardless of what password we provide.</li></ol><p>Modify the <code>strcmp()</code> function in the <code>strcmp.c</code> source code file to alter the <code>crackme2</code> program behavior in each of the two ways shown above.
To test it, use the <code>Makefile</code>:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="05-tutorial---network-netstat-and-netcat">05. Tutorial - Network: <code>netstat</code> and <code>netcat</code><a class="hash-link" href="#05-tutorial---network-netstat-and-netcat" title="Direct link to heading">​</a></h3><p>Services running on remote machines offer a gateway to those particular machines.
Whether it&#x27;s improper handling of the data received from clients, or a flaw in the protocol used between server and clients, certain privileges can be obtained if care is not taken.
We&#x27;ll explore some tools and approaches to analyzing remote services.
To follow along, use the server and client programs from <a href="/binary-security/Binary Analysis/Exploration Tools/Reading/activities/05-tutorial-network-netstat-netcat/src"><code>05-tutorial-network-netstat-netcat</code></a>.</p><p>First of all, start the server:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome to the awesome server.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Valid commands are:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">status</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Running any of them at this point doesn&#x27;t offer much help.
We&#x27;ll come back to this later.</p><p>The most straightforward way to see what a server does is the <a href="https://man7.org/linux/man-pages/man8/netstat.8.html" target="_blank" rel="noopener noreferrer"><code>netstat</code></a> utility.</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ netstat -tlpn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(Not all processes could be identified, non-owned process info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> will not be shown, you would have to be root to see it all.)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Active Internet connections (only servers)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp        0      0 0.0.0.0:36732           0.0.0.0:*               LISTEN      3062/steam</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp        0      0 127.0.0.1:57343         0.0.0.0:*               LISTEN      3062/steam</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp        0      0 127.0.0.1:31337         0.0.0.0:*               LISTEN      15022/./server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp        0      0 0.0.0.0:58154           0.0.0.0:*               LISTEN      3062/steam</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp        0      0 127.0.0.1:60783         0.0.0.0:*               LISTEN      2644/SpiderOak</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp        0      0 192.168.101.1:53        0.0.0.0:*               LISTEN      -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp        0      0 192.168.100.1:53        0.0.0.0:*               LISTEN      -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp        0      0 0.0.0.0:44790           0.0.0.0:*               LISTEN      2644/SpiderOak</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp6       0      0 :::631                  :::*                    LISTEN      -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here we&#x27;re looking at all the programs that are listening (<code>-l</code>) on a TCP port (<code>-t</code>).
We&#x27;re also telling <code>netcat</code> not to resolve hosts (<code>-n</code>) and to show the process that is listening (<code>-p</code>).
We can see that our server is listening on port <code>31337</code>.
Let&#x27;s keep that in mind and see how the client behaves:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Usage: ./client &lt;client name&gt; &lt;server IP&gt; &lt;server port&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./client the_laughing_man localhost 31337</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome to the awesome server.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Valid commands are:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listclients</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">infoclient &lt;client name&gt; [ADMIN access required]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name, IP, port, privileged, connected time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sendmsg &lt;client name&gt; &lt;message&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter a command (or &#x27;quit&#x27; to exit):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listclients</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connected clients are:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">the_laughing_man</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter a command (or &#x27;quit&#x27; to exit):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sendmsg the_laughing_man test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter a command (or &#x27;quit&#x27; to exit):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Message from the_laughing_man</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter a command (or &#x27;quit&#x27; to exit):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">infoclient the_laughing_man</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Not enough minerals!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter a command (or &#x27;quit&#x27; to exit):</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So we can do anything except the privileged command <code>infoclient</code>.
Running <code>status</code> on the server yields no information.
What can we do now?</p><p>We can see what the server and client are exchanging at an application level by capturing the traffic with the <a href="https://man7.org/linux/man-pages/man1/tcpdump.1.html" target="_blank" rel="noopener noreferrer"><code>tcpdump</code></a> utility.
Start <code>tcpdump</code>, the server and then the client, and run the commands again.
When you&#x27;re done, stop <code>tcpdump</code> with <code>Ctrl+C</code>.</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># tcpdump -i any -w crackme5.pcap &#x27;port 31337&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcpdump: listening on any, link-type LINUX_SLL (Linux cooked), capture size 65535 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">^C21 packets captured</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">42 packets received by filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0 packets dropped by kernel</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here we&#x27;re telling <code>tcpdump</code> to listen on all available interfaces, write the capture to the <code>crackme5.pcap</code> file and only log packets that have the source or destination port equal to 31337.</p><p>We can then open our capture with <a href="https://www.wireshark.org/" target="_blank" rel="noopener noreferrer"><code>Wireshark</code></a> in order to analyze the packets in a friendlier manner.
You can look at the packets exchanged between server and client.
Notice that there seems to be some sort of protocol where values are delimited by the pipe character.
What is especially interesting is the first data packet sent from the client to the server, which sends <code>the_laughing_man|false</code>.
While we&#x27;ve specified the client name, there was nothing we could specify via the client command-line in order to control the second value.</p><p>However, since this seems to be a plain text protocol, there is an alternative course of action available.
The <a href="https://linux.die.net/man/1/nc" target="_blank" rel="noopener noreferrer"><code>netcat</code></a> utility allows for arbitrary clients and servers.
It just needs a server address and a server port in client mode.
We can use it instead of the &quot;official&quot; client and see what happens when we craft the first message.
Go ahead!
Start the server again and a normal client.</p><p>Connect to the server using <code>netcat</code>.
Then send out the required string through the <code>netcat</code> connection with true as the second parameter and see if you can find out anything about the normal client.</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># netcat localhost 31337</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome to the awesome server.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Valid commands are:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listclients</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">infoclient &lt;client name&gt; [ADMIN access required]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name, IP, port, privileged, connected time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sendmsg &lt;client name&gt; &lt;message&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="doing-it-in-python">Doing it in Python<a class="hash-link" href="#doing-it-in-python" title="Direct link to heading">​</a></h4><p>You can create a sever and a client in Python only.
We can use the <code>server.py</code> and <code>client.py</code> scripts.
Check them out first.</p><p>Then run the server by using:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python server.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It now accepts connections on TCP port 9999 as you can see by using <code>netstat</code>:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ netstat -tlpn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcp        0      0 127.0.0.1:9999          0.0.0.0:*               LISTEN      12541/python</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[...]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now you can test it using the Python client:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ python client.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sending &#x27;anaaremere&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">received &#x27;ANAAREMERE&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can do the same using <code>netcat</code> as the client:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ nc localhost 9999</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">anaaremere</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ANAAREMERE</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="doing-it-only-with-netcat">Doing it Only with <code>netcat</code><a class="hash-link" href="#doing-it-only-with-netcat" title="Direct link to heading">​</a></h4><p>We can still simulate a network connection using <code>netcat</code> only, both for starting the server and for running the client.</p><p>Start the server with:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nc -l -p 4444</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now run the client and send messages by writing them to standard input:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ nc localhost 4444</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aaaaa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bbbbb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Messages you write to the client and up in the server.</p><p>This goes both ways: if you write messages on the server they end up in the client.
Try that.</p><p>If you want to send a large chunk of data you can redirect a file.
Start the server again:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nc -l -p 4444</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>and now send the file to it:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /etc/services | nc localhost 4444</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It&#x27;s now on the server-side.</p><p>You can also do it with UDP, instead of TCP by using the <code>-u</code> flag both for the server and the client.
Start the server using:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nc -u -l -p 4444</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And run the client using:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /etc/services | nc -u localhost 4444</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>That&#x27;s how we use <code>netcat</code> (the network swiss army knife).</p><p>You can also look into <a href="https://linux.die.net/man/1/socat" target="_blank" rel="noopener noreferrer"><code>socat</code></a> for a complex tool on dealing with sockets.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="06-tutorial---open-files">06. Tutorial - Open files<a class="hash-link" href="#06-tutorial---open-files" title="Direct link to heading">​</a></h3><p>Let&#x27;s remember how files and programs relate in Linux.</p><p><img loading="lazy" alt="Files" src="/binary-security/assets/images/files-f31b9a44ab36ace0e629c47195b09d24.png" width="960" height="720" class="img_ev3q"></p><p>Let&#x27;s also remember that, in Linux, <code>file</code> can mean one of many things:</p><ul><li>regular file</li><li>directory</li><li>block device</li><li>character device</li><li>named pipe</li><li>symbolic or hard link</li><li>socket</li></ul><p>Let&#x27;s look at the previous server from <code>crackme5</code>.
Start it up once again.</p><p>While previously we&#x27;ve used <code>netstat</code> to gather information about it, that was by no means the only solution.
<a href="https://linux.die.net/man/8/lsof" target="_blank" rel="noopener noreferrer"><code>lsof</code></a> is a tool that can show us what files a process has opened:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ lsof -c server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COMMAND  PID   USER   FD   TYPE DEVICE SIZE/OFF    NODE NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server  9678 amadan  cwd    DIR    8,6     4096 1482770 /home/amadan/projects/sss/session01/crackmes/crackme5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server  9678 amadan  rtd    DIR    8,6     4096       2 /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server  9678 amadan  txt    REG    8,6    17524 1442625 /home/amadan/projects/sss/session01/crackmes/crackme5/server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server  9678 amadan  mem    REG    8,6  1753240 3039007 /lib64/libc-2.17.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server  9678 amadan  mem    REG    8,6    88088 3039019 /lib64/libnsl-2.17.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server  9678 amadan  mem    REG    8,6   144920 3038998 /lib64/ld-2.17.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server  9678 amadan    0u   CHR  136,2      0t0       5 /dev/pts/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server  9678 amadan    1u   CHR  136,2      0t0       5 /dev/pts/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server  9678 amadan    2u   CHR  136,2      0t0       5 /dev/pts/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server  9678 amadan    3u  IPv4 821076      0t0     TCP *:31337 (LISTEN)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can see the standard file descriptors found in any process, as well as our socket.</p><ul><li>The <code>FD</code> column shows the file descriptor entry for a file, or a role in case of special files.
We notice the current working directory (<code>cwd</code>), the root directory (<code>rtd</code>), the current executable (<code>txt</code>), some memory mapped files (<code>mem</code>) and the file descriptors (0-3).
For normal file descriptors, <code>r</code> means read access, <code>w</code> means write access and <code>u</code> means both.</li><li>The <code>TYPE</code> column shows whether we&#x27;re dealing with a directory (<code>DIR</code>), a regular file (<code>REG</code>), a character device (<code>CHR</code>), a socket (<code>IPv4</code>) or other type of file.</li><li>The <code>NODE</code> column shows the inode of the file, or a class marker as is the case for the socket.</li><li>The <code>NAME</code> column shows the path to the file, or the bound address and port for a socket.</li></ul><p>We&#x27;ve left out some details since they are not relevant for our purposes.
Feel free to read the manual page.</p><p>You could also get some hint that there is an open socket by looking into the <code>/proc</code> virtual filesystem:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ls -l /proc/`pidof server`/fd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">total 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwx------ 1 amadan amadan 64 Jun 15 22:04 0 -&gt; /dev/pts/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwx------ 1 amadan amadan 64 Jun 15 22:04 1 -&gt; /dev/pts/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwx------ 1 amadan amadan 64 Jun 15 22:03 2 -&gt; /dev/pts/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwx------ 1 amadan amadan 64 Jun 15 22:04 3 -&gt; socket:[883625]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We&#x27;ll be using <a href="/binary-security/Binary Analysis/Exploration Tools/Reading/activities/06-tutorial-open-files/src"><code>crackme6</code></a> for the next part of this section.
Try the conventional means of <code>strings</code> and <code>ltrace</code> on it.
Then run it normally:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./crackme6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type &#x27;start&#x27; to begin authentication test</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Before complying to what the program tells us, let&#x27;s use <code>lsof</code> to see what we can find out:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ lsof -c crackme6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COMMAND    PID   USER   FD   TYPE DEVICE SIZE/OFF    NODE NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crackme6 10466 amadan  cwd    DIR    8,6     4096 1482769 /home/amadan/projects/sss/session01/06-tutorial-open-files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crackme6 10466 amadan  rtd    DIR    8,6     4096       2 /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crackme6 10466 amadan  txt    REG    8,6    12922 5377126 /home/amadan/projects/sss/session01/06-tutorial-open-files/crackme6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crackme6 10466 amadan  mem    REG    8,6  1753240 3039007 /lib64/libc-2.17.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crackme6 10466 amadan  mem    REG    8,6   100680 3039039 /lib64/libpthread-2.17.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crackme6 10466 amadan  mem    REG    8,6   144920 3038998 /lib64/ld-2.17.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crackme6 10466 amadan    0u   CHR  136,2      0t0       5 /dev/pts/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crackme6 10466 amadan    1u   CHR  136,2      0t0       5 /dev/pts/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crackme6 10466 amadan    2u   CHR  136,2      0t0       5 /dev/pts/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crackme6 10466 amadan    3w  FIFO   0,32      0t0  988920 /tmp/crackme6.fifo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crackme6 10466 amadan    4r  FIFO   0,32      0t0  988920 /tmp/crackme6.fifo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There seems to be a named pipe used by the executable.
Let&#x27;s look at it:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">more /tmp/crackme6.fifo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now go back again at the <code>crackme6</code> console and type <code>start</code>.
If you see the message that the authentication test has succeeded, quit and try again.
If you do not see the message, kill the <code>crackme6</code> process, look at the more command output and then delete the pipe file.
Now try the password.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="misc">Misc<a class="hash-link" href="#misc" title="Direct link to heading">​</a></h4><p>There are other sources of information available about running processes if you prefer to do things by hand such as:</p><ul><li><code>/proc/&lt;PID&gt;/environ</code>: all environment variables given when the process was started</li><li><code>/proc/&lt;PID&gt;/fd</code>: opened file descriptors.</li><li><code>/proc/&lt;PID&gt;/mem</code>: address space layout</li><li><code>/proc/&lt;PID&gt;/cwd</code>: symlink to working directory</li><li><code>/proc/&lt;PID&gt;/exe</code>: symlink to binary image</li><li><code>/proc/&lt;PID&gt;/cmdline</code>: complete program command-line, with arguments</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="challenges">Challenges<a class="hash-link" href="#challenges" title="Direct link to heading">​</a></h2><p>Challenges can be found in the <code>activities/&lt;CHALLENGE_NUMBER&gt;-challenge-&lt;CHALLENGE_NAME&gt;</code> directory.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="07-challenge---perfect-answer">07. Challenge - Perfect Answer<a class="hash-link" href="#07-challenge---perfect-answer" title="Direct link to heading">​</a></h3><p>For this task use the <a href="/binary-security/Binary Analysis/Exploration Tools/Reading/activities/07-challenge-perfect-answer/src"><code>perfect</code></a> binary.</p><p>Can you find the flag?</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="08-challenge---lots-of-strings">08. Challenge - Lots of strings<a class="hash-link" href="#08-challenge---lots-of-strings" title="Direct link to heading">​</a></h3><p>Use the <a href="/binary-security/Binary Analysis/Exploration Tools/Reading/activities/08-challenge-lots-of-strings/src"><code>lots_of_strings</code></a> binary.</p><p>Can you find the <strong>password</strong>?</p><p>Hint: use the tools presented in the tutorials.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="09-challenge---sleepy-cats">09. Challenge - Sleepy cats<a class="hash-link" href="#09-challenge---sleepy-cats" title="Direct link to heading">​</a></h3><p>For this task use the <a href="/binary-security/Binary Analysis/Exploration Tools/Reading/activities/09-challenge-sleepy-cats/src"><code>sleepy</code></a> binary.</p><p>The <code>sleep()</code> function takes too much.
Ain&#x27;t nobody got time for that.
We want the flag NOW!</p><p>Modify the binary in order to get the flag.</p><p>To edit a binary, you can use <a href="https://vim.fandom.com/wiki/Hex_dump#Editing_binary_files" target="_blank" rel="noopener noreferrer"><code>vim</code> + <code>xxd</code></a> or <code>Bless</code>.
We strongly encourage you to use <code>Bless</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="10-challenge---hidden">10. Challenge - Hidden<a class="hash-link" href="#10-challenge---hidden" title="Direct link to heading">​</a></h3><p>For this challenge use the <a href="/binary-security/Binary Analysis/Exploration Tools/Reading/activities/10-challenge-hidden/src"><code>hidden</code></a> binary.</p><p>Can you find the hidden flag?</p><p>You could use <code>ltrace</code> and <code>strace</code> to find the flag.
But try to make it give you the flag by simply altering the environment, do not attach to the executable.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-challenge---detective">11. Challenge - Detective<a class="hash-link" href="#11-challenge---detective" title="Direct link to heading">​</a></h3><p>This challenge runs remotely at <code>141.85.224.104:31337</code>.
You can use <code>netcat</code> to connect to it.</p><p>Investigate the <a href="/binary-security/Binary Analysis/Exploration Tools/Reading/activities/11-challenge-detective/src"><code>detective</code></a> binary.
See what it does and work to get the flag.</p><p>You can start from the <a href="/binary-security/Binary Analysis/Exploration Tools/Reading/activities/11-challenge-detective/sol/exploit_template.py"><code>sol/exploit_template.py</code></a> solution template script.</p><p>There is a bonus to this challenge and you will be able to find another flag.
See that below.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="bonus-get-the-second-flag">Bonus: Get the Second Flag<a class="hash-link" href="#bonus-get-the-second-flag" title="Direct link to heading">​</a></h4><p>You can actually exploit the remote <a href="/binary-security/Binary Analysis/Exploration Tools/Reading/activities/11-challenge-detective/src"><code>detective</code></a> executable and get the second flag.
Look thoroughly through the executable and craft your payload to exploit the remote service.</p><p>You need to keep the connection going.
Use the construction: <code>cat /path/to/file - | nc &lt;host&gt; &lt;port&gt;</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="extra">Extra<a class="hash-link" href="#extra" title="Direct link to heading">​</a></h3><p>If you want some more, have a go at the <a href="/binary-security/Binary Analysis/Exploration Tools/Reading/activities/bonus/src"><code>bonus</code></a> task.
It is a simplified CTF task that you should be able to solve using the information learned in this lab.</p><p>Hint: This executable needs elevated permissions (run with <code>sudo</code>).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="further-pwning">Further pwning<a class="hash-link" href="#further-pwning" title="Direct link to heading">​</a></h3><p><a href="http://pwnable.kr/" target="_blank" rel="noopener noreferrer"><code>pwnable.kr</code></a> is a wargames site with fun challenges of different difficulty levels.
After completing all tutorials and challenges in this session, you should be able to go there and try your hand at the following games from Toddler&#x27;s bottle: <code>fd</code>, <code>collision</code>, <code>bof</code>, <code>passcode</code>, <code>mistake</code>, <code>cmd1</code>, <code>blukat</code> (of course, you are encouraged to try any other challenges, but they might get frustrating, as they require knowledge of notions we will explore in future sessions).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="further-reading">Further Reading<a class="hash-link" href="#further-reading" title="Direct link to heading">​</a></h2><ul><li><a href="https://man7.org/linux/man-pages/man1/ltrace.1.html" target="_blank" rel="noopener noreferrer"><code>ltrace</code></a></li><li><a href="https://man7.org/linux/man-pages/man2/syscalls.2.html" target="_blank" rel="noopener noreferrer"><code>syscalls</code></a></li><li><a href="https://man7.org/linux/man-pages/man2/ptrace.2.html" target="_blank" rel="noopener noreferrer"><code>ptrace</code></a></li><li><a href="https://man7.org/linux/man-pages/man2/ptrace.2.html" target="_blank" rel="noopener noreferrer"><code>ldconfig</code></a></li><li><a href="https://linux.die.net/man/1/socat" target="_blank" rel="noopener noreferrer"><code>socat</code></a></li><li><a href="https://linux.die.net/man/8/lsof" target="_blank" rel="noopener noreferrer"><code>lsof</code></a></li><li><a href="https://vim.fandom.com/wiki/Hex_dump#Editing_binary_files" target="_blank" rel="noopener noreferrer"><code>vim</code> + <code>xxd</code></a></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/binary-security/Binary Analysis/Exploration Tools/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Exploration Tools</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/binary-security/Binary Analysis/Exploration Tools/Exploration-Tools"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Exploration-Tools</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tutorials" class="table-of-contents__link toc-highlight">Tutorials</a><ul><li><a href="#01-tutorial---poor-mans-technique-strings" class="table-of-contents__link toc-highlight">01. Tutorial - Poor Man&#39;s Technique: <code>strings</code></a></li><li><a href="#02-tutorial---execution-tracing-ltrace-and-strace" class="table-of-contents__link toc-highlight">02. Tutorial - Execution Tracing (<code>ltrace</code> and <code>strace</code>)</a></li><li><a href="#03-tutorial---symbols-nm" class="table-of-contents__link toc-highlight">03. Tutorial - Symbols: <code>nm</code></a></li><li><a href="#04-tutorial---library-dependencies" class="table-of-contents__link toc-highlight">04. Tutorial - Library Dependencies</a></li><li><a href="#05-tutorial---network-netstat-and-netcat" class="table-of-contents__link toc-highlight">05. Tutorial - Network: <code>netstat</code> and <code>netcat</code></a></li><li><a href="#06-tutorial---open-files" class="table-of-contents__link toc-highlight">06. Tutorial - Open files</a></li></ul></li><li><a href="#challenges" class="table-of-contents__link toc-highlight">Challenges</a><ul><li><a href="#07-challenge---perfect-answer" class="table-of-contents__link toc-highlight">07. Challenge - Perfect Answer</a></li><li><a href="#08-challenge---lots-of-strings" class="table-of-contents__link toc-highlight">08. Challenge - Lots of strings</a></li><li><a href="#09-challenge---sleepy-cats" class="table-of-contents__link toc-highlight">09. Challenge - Sleepy cats</a></li><li><a href="#10-challenge---hidden" class="table-of-contents__link toc-highlight">10. Challenge - Hidden</a></li><li><a href="#11-challenge---detective" class="table-of-contents__link toc-highlight">11. Challenge - Detective</a></li><li><a href="#extra" class="table-of-contents__link toc-highlight">Extra</a></li><li><a href="#further-pwning" class="table-of-contents__link toc-highlight">Further pwning</a></li></ul></li><li><a href="#further-reading" class="table-of-contents__link toc-highlight">Further Reading</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://security-summer-school.github.io/binary/" target="_blank" rel="noopener noreferrer" class="footer__link-item">site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/SSSUPB/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 SSS Team</div></div></div></footer></div>
<script src="/binary-security/assets/js/runtime~main.74200969.js"></script>
<script src="/binary-security/assets/js/main.d9be8505.js"></script>
</body>
</html>