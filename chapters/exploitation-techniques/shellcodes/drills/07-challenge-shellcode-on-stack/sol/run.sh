#!/bin/bash
# Build the Docker image from the correct directory
cd ..
docker build -f src/Dockerfile -t challenge07 .

# Run container in background
docker run -d --name challenge07 -p 31345:31345 challenge07

# Copy the binary from the container for local analysis
docker cp challenge07:/app/vuln sol/vuln

# Navigate to the sol directory and run the exploit
cd sol
python3 exploit.py

# Cleanup: Remove the local copy of the binary and stop the container
rm -f vuln
docker stop challenge07
docker rm -f challenge07