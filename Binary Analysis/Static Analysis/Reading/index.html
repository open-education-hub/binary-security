<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Binary Analysis/Static Analysis/Reading/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Static Analysis | Binary Security</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://open-education-hub.github.io/binary-security/Binary Analysis/Static Analysis/Reading/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Static Analysis | Binary Security"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="canonical" href="http://open-education-hub.github.io/binary-security/Binary Analysis/Static Analysis/Reading/"><link data-rh="true" rel="alternate" href="http://open-education-hub.github.io/binary-security/Binary Analysis/Static Analysis/Reading/" hreflang="en"><link data-rh="true" rel="alternate" href="http://open-education-hub.github.io/binary-security/Binary Analysis/Static Analysis/Reading/" hreflang="x-default"><link rel="stylesheet" href="/binary-security/assets/css/styles.a69a9d41.css">
<link rel="preload" href="/binary-security/assets/js/runtime~main.74200969.js" as="script">
<link rel="preload" href="/binary-security/assets/js/main.d9be8505.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/binary-security/"><div class="navbar__logo"><img src="/binary-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/binary-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Binary Security</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/binary-security/Binary Analysis">Binary Analysis</a><a class="navbar__item navbar__link" href="/binary-security/Exploitation Techniques">Exploitation Techniques</a><a class="navbar__item navbar__link" href="/binary-security/Mitigation and Defensive Strategies">Mitigation and Defensive Strategies</a><a class="navbar__item navbar__link" href="/binary-security/Extra">Extra</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/binary-security/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/binary-security/Binary Analysis/">Binary Analysis</a><button aria-label="Toggle the collapsible sidebar category &#x27;Binary Analysis&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/binary-security/Binary Analysis/Exploration Tools/">Exploration Tools</a><button aria-label="Toggle the collapsible sidebar category &#x27;Exploration Tools&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/binary-security/Binary Analysis/Executables and Processes/">Executables and Processes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Executables and Processes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/binary-security/Binary Analysis/Static Analysis/">Static Analysis</a><button aria-label="Toggle the collapsible sidebar category &#x27;Static Analysis&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/binary-security/Binary Analysis/Static Analysis/Reading/">Reading</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/binary-security/Binary Analysis/Static Analysis/Drills/">Drills</a><button aria-label="Toggle the collapsible sidebar category &#x27;Drills&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/binary-security/Binary Analysis/Static Analysis/Demos/">Demos</a><button aria-label="Toggle the collapsible sidebar category &#x27;Demos&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/binary-security/Binary Analysis/Static Analysis/Static-Analysis">Slides</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/binary-security/Binary Analysis/Dynamic Analysis/">Dynamic Analysis</a><button aria-label="Toggle the collapsible sidebar category &#x27;Dynamic Analysis&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/binary-security/Exploitation Techniques/">Exploitation Techniques</a><button aria-label="Toggle the collapsible sidebar category &#x27;Exploitation Techniques&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/binary-security/Mitigation and Defensive Strategies/">Mitigation and Defensive Strategies</a><button aria-label="Toggle the collapsible sidebar category &#x27;Mitigation and Defensive Strategies&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/binary-security/Extra/">Extra</a><button aria-label="Toggle the collapsible sidebar category &#x27;Extra&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/binary-security/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/binary-security/Binary Analysis/"><span itemprop="name">Binary Analysis</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/binary-security/Binary Analysis/Static Analysis/"><span itemprop="name">Static Analysis</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Reading</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Static Analysis</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h2><p>Sometimes we are either unable or reluctant to run an unknown executable.
This inability to run the file can be caused by a multitude of factors, such as not having the correct dependencies or runtimes for it.
In addition, it is often unsafe to run binaries without analysing them first.
Today we&#x27;ll learn about one method of analysis, called <strong>static analysis</strong>.</p><p>Thus, static analysis allows us to understand the behaviour of the application by displaying either its assembly code or an equivalent high-level code.
In order to obtain the assembly code, via a procedure called <strong>disassembling</strong>, currently there are two approaches being used, which we&#x27;ll describe in the following sections.
The high-level code, is <em>deduced</em> from the machine code, through a more complex process called <strong>decompilation</strong>, which sometimes might make it a bit inaccurate, when compared to the assembly code.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="disassembling-executables">Disassembling Executables<a class="hash-link" href="#disassembling-executables" title="Direct link to heading">​</a></h2><p>There are two main strategies when it comes to disassembly.
They are called <strong>Linear Sweep</strong> and <strong>Recursive Traversal</strong>.
As we&#x27;ll see below, the main difference between the two is their accuracy</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="linear-sweep">Linear Sweep<a class="hash-link" href="#linear-sweep" title="Direct link to heading">​</a></h3><p>The first strategy that we&#x27;ll look at is <em>Linear Sweep</em>.
A very popular tool that uses this strategy is <code>objdump</code>.
What <em>Linear Sweep</em> does is it parses the <code>.text</code> section of the executable from the beginning to the end and translates each encountered machine code instruction into its equivalent Assembly instruction.
It&#x27;s a fast and simple algorithm.
Being so simple, however, renders it vulnerable to being mislead.
This can happen in a few ways.
One way is to insert an inappropriate instruction somewhere in the <code>.text</code> section.
When the algorithm reaches it, it will try to interpret it as something meaningful and output a completely different Assembly code that would make no sense.</p><p>Let&#x27;s consider the code below, which is also available <a href="https://github.com/hexcellents/sss-exploit/blob/master/sessions/04-static-analysis/activities/01-tutorial-disassemble-methods/src/wrong.c" target="_blank" rel="noopener noreferrer">in this repository</a>:</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">asm</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">volatile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;A: jmp B\n\t&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;.byte 0xde\n\t&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;.byte 0xad\n\t&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;.byte 0xc0\n\t&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;.byte 0xde\n\t&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;jmp -1\n\t&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;B:\n\t&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;What is wrong with me :-s?\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Take a look at the Makefile rule for <code>wrong</code> and notice that it <strong>strips</strong> the binary:</p><div class="language-makefile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-makefile codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token target symbol" style="color:#36acaa">wrong</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> wrong.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token variable" style="color:#36acaa">$</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CFLAGS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$&lt;</span><span class="token plain"> -o </span><span class="token variable" style="color:#36acaa">$@</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -strip </span><span class="token variable" style="color:#36acaa">$@</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If we remove the line at the end of the snipped above and then disassemble the executable, we can see our inline assembly code (<code>de ad c0 de</code>) together with the encoding of <code>jmp -1</code>.
The binary code is as expected, but the way it&#x27;s interpreted is completely off.
This happens because <em>objdump</em> gets &quot;confused&quot; when reaching the bytes <code>de ad c0 de</code> and can&#x27;t figure out that the code is meaningless.</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">080491ab &lt;A&gt;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 80491ab:       eb 09                   jmp    80491b6 &lt;B&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 80491ad:       de ad c0 de e9 49       fisubr WORD PTR [ebp+0x49e9dec0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 80491b3:       6e                      outs   dx,BYTE PTR ds:[esi]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 80491b4:       fb                      sti</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 80491b5:       f7                      .byte 0xf7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">080491b6 &lt;B&gt;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 80491b6:       83 ec 0c                sub    esp,0xc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If we restore the line where the binary is stripped, recompile and disassemble it once more, we see that this time, <code>objdump</code> gets completely lost when it encounters our <code>de ad c0 de</code> sequence.
This is because, previously, it used symbols in the binary, such as <code>B</code>, to figure out where some of the real instructions started.
Now, without the help of those symbols, <code>objdump</code> doesn&#x27;t manage to output a coherent Assembly code.</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> 804840c:       eb 09                   jmp    8048417 &lt;__libc_start_main@plt+0x127&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 804840e:       de ad c0 de e9 e8       fisubr WORD PTR [ebp-0x17162140]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8048414:       7b fb                   jnp    8048411 &lt;__libc_start_main@plt+0x121&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8048416:       f7 83 ec 0c 68 c0 84    test   DWORD PTR [ebx-0x3f97f314],0xe8080484</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 804841d:       04 08 e8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8048420:       ac                      lods   al,BYTE PTR ds:[esi]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8048421:       fe                      (bad)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8048422:       ff                      (bad)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8048423:       ff 83 c4 10 b8 ff       inc    DWORD PTR [ebx-0x47ef3c]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8048429:       ff                      (bad)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 804842a:       ff                      (bad)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 804842b:       ff 8b 4d fc c9 8d       dec    DWORD PTR [ebx-0x723603b3]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8048431:       61                      popa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8048432:       fc                      cld</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8048433:       c3                      ret</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In order to avoid traps like the one showcased above, we need to use smarter disassembly techniques, such as <em>Recursive Traversal</em>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="recursive-traversal">Recursive Traversal<a class="hash-link" href="#recursive-traversal" title="Direct link to heading">​</a></h3><p>Note that, in the example above, the misleading instruction is never executed.
If it were, the program would crash after receiving a <code>SIGILL</code> signal and after outputting <code>Illegal instruction (core dumped)</code>, because the CPU would not know how to decode that particular instruction.
But if we run the binary above, we notice that it doesn&#x27;t crash.
So that instruction is nothing but dead code.
As a result, it&#x27;s useless to us no matter what it means.
And this is where <em>Recursive Traversal</em> comes in.</p><p>This strategy doesn&#x27;t start the disassembly at the beginning of the <code>.text</code> section, but at the entry point (the address of the <code>_start</code> symbol) and disassembles the instructions linearly, while also considering <strong>jumps</strong>.
Thus, when encountering code branches, the algorithm follows them and creates what&#x27;s called a <strong>Control Flow Graph (CFG)</strong>, where each node is called a <strong>Basic Block (BB)</strong> and is made up of instructions that are always executed in that order, regardless of conditional jumps or function calls.
Take a look at the CFG below and note the BBs and the jumps that make up the arches.
The code comes from the <code>hyp3rs3rv3r</code> binary, which can be found <a href="https://github.com/hexcellents/sss-exploit/tree/master/sessions/04-static-analysis/activities/02-tutorial-ida-time/src" target="_blank" rel="noopener noreferrer">here</a>.
To make things harder, this executable was also stripped.
<img loading="lazy" alt="CFG created by IDA" src="/binary-security/assets/images/fork_xref_2-cbbaaa29d6a79b16ccf9c7d72cc30a37.png" width="400" height="583" class="img_ev3q"></p><p>In conclusion, we can look at the CFG as being a DFS (recursive) traversal of the code, separated into BBs, with <code>ret</code> instructions acting as <em>back edges</em>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ida-and-ghidra">IDA and Ghidra<a class="hash-link" href="#ida-and-ghidra" title="Direct link to heading">​</a></h2><p>The tool that we used in order to generate the image above is called <a href="https://www.hex-rays.com/products/ida/support/download_freeware/" target="_blank" rel="noopener noreferrer">IDA</a>.
Next, we&#x27;ll learn how to use it!</p><p>We&#x27;ll showcase the functionalities of IDA by disassembling the <code>hyp3rs3rv3r</code> binary.
The first screen you are presented with is the following:</p><p><img loading="lazy" alt="Initial IDA Screen" src="/binary-security/assets/images/ida_initial_screen-2ccb264922a514f0f40dbc43ea8dff4f.png" width="600" height="396" class="img_ev3q"></p><p>Main components:</p><ul><li>On the left you have the <strong>Function window</strong> with the list of identified subroutines, functions or external functions called by the binary.
They are color coded according to the legend right above it.</li><li>Under it you have a graph overview of the view presented on the right.</li><li>On the right you have multiple tabs, with the <strong>Function summary</strong> selected in the IDA-view.
We will not be using this.
Instead, we will switch to the complete <strong>Graph View</strong> of functions by pressing the space bar.
This graph is the CFG we mentioned earlier.</li></ul><p>Upon pressing space bar and navigating in the <strong>Function window</strong> to functions that are not coloured (meaning they are part of this binary) we get the following view:
<img loading="lazy" alt="IDA - First View" src="/binary-security/assets/images/ida_first_view-15240b5bcf4ffef9a1a20eea4decd16f.png" width="600" height="241" class="img_ev3q"></p><p>When reversing binaries, we will see this particular Assembly construct a lot, as it is the standard one generated by <code>gcc</code>.
Remember from <a href="/binary-security/Binary Analysis/Executables and Processes/Reading">the &quot;Executables an Processes&quot; session</a> that <a href="/binary-security/Binary Analysis/Static Analysis/Reading/refspecs.linuxbase.org/LSB_3.1.1/LSB-Core-generic/LSB-Core-generic/baselib---libc-start-main-.html"><code>__libc_start_main</code></a> is the wrapper that calls <code>main</code>.
We now rename the last argument pushed on the stack to main.
Press <code>n</code> and enter the new name.
Now you have your first function identified.
Click on it to see what <code>main</code> does:</p><p><img loading="lazy" alt="main" src="/binary-security/assets/images/ida_main-843538c9f43f8c93ebd5a3617728722e.png" width="600" height="348" class="img_ev3q"></p><p>Note how the execution is neatly laid out in the CFG view.
If you look at the left panel you can see the complete view.
The execution is divided because of conditional and unconditional branches.
Let&#x27;s figure out what happens by analyzing the assembly code:</p><p>First we have the function prologue, stack alignment and stack allocation:</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">push    ebp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov     ebp, esp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">and     esp, 0FFFFFFF0h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sub     esp, 450h</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, a variable on the stack is initialized to 1.
If you click on <code>434h</code> it will become highlighted and you can scroll through the whole function to see where it&#x27;s used later.
We&#x27;ll ignore this for now.</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mov     dword ptr [esp+434h], 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, we see the first branching:</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmp     [ebp+arg_0], 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jz      short loc_8049068</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Remember</strong>:
On 32 bit systems, <code>[ebp + 0]</code> is the saved <code>ebp</code>, <code>[ebp + 4]</code> is the return address and <code>[ebp + 8]</code> is the first argument to the current function.
IDA follows a slightly different naming convention: <code>[ebp + 8]</code> is named <code>[ebp+arg_0]</code>. <code>[ebp + 12]</code> is named <code>[ebp+arg_4]</code> etc.
You can rename those <code>arg_*</code> constructs if you want, anyway.</p><p>So it&#x27;s referring to the first argument: <code>argc</code>.
Basically, what it does is:</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argc </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">goto</span><span class="token plain"> loc_8049068</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>What does the <code>else</code> branch do?</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mov     eax, [ebp+arg_4]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov     eax, [eax]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov     [esp+4], eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov     dword ptr [esp], offset format ; &quot;Usage: %s &lt;banner_file&gt;\n&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">call    _printf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov     dword ptr [esp], 0 ; status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">call    _exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It&#x27;s pretty straightforward if you remember the tasks from <a href="https://github.com/hexcellents/sss-exploit/tree/master/sessions/03-executable-file-formats" target="_blank" rel="noopener noreferrer">Session 02</a>.
The second argument (<code>argv</code>) is dereferenced and pushed on the stack along with a format string.
Then <code>printf</code> is called.
Next, <code>exit</code> is called with a status of 0.</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argc </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">goto</span><span class="token plain"> loc_8049068</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%s &lt;banner_file&gt;\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now let&#x27;s do something a bit more advanced: we want to identify the 2 commands that the server accepts by using static analysis.
How do we approach this problem as fast as possible?
We already know that the server accepts multiple clients.
It can do this through forking.
Let&#x27;s see where <code>fork</code> is called in the program.
First find the <code>fork</code> function on the left panel and select it.
Now you see a stub to it from the <code>PLT</code> section.
We want to find all locations in the program that call this function.
You can achieve this by obtaining all the <strong>cross-references (xrefs)</strong> to it by pressing <code>x</code>.
You should get the following screen:</p><p><img loading="lazy" alt="fork cross-references 1" src="/binary-security/assets/images/fork_xref_1-85f1d0232651a1b8e0dc2df57af3979f.png" width="600" height="347" class="img_ev3q"></p><p>Click that location and you will get to the forking point:</p><p><img loading="lazy" alt="fork cross-references 2" src="/binary-security/assets/images/fork_xref_2-cbbaaa29d6a79b16ccf9c7d72cc30a37.png" width="400" height="583" class="img_ev3q"></p><p>You can see that the return value is stored on the stack at <code>[esp+438h]</code>, some error checking (<code>perror</code> and <code>exit</code>) is done and then the return value is checked for 0 (as we traditionally do for <code>fork</code> calls).
The child will execute <code>sub_8048ED7</code> and the parent will loop back.
You can rename <code>sub_8048ED7</code> to something more legible such as <code>handle_child_process</code>
In this function you can now clearly see the two commands and which function is called for each:</p><p><img loading="lazy" alt="handle_child_process" src="/binary-security/assets/images/handle_child_process-f520438be14ce78f7514ced2194469df.png" width="600" height="571" class="img_ev3q"></p><p>It looks like the one on the left, <code>sub_8048B0B</code> handles the <code>LIST</code> command so we rename it to <code>handle_LIST</code>.
As expected, it calls <code>opendir</code> and <code>readdir</code> to read all the files in the current directory, then writes them to the socket.</p><p><img loading="lazy" alt="handle_LIST" src="/binary-security/assets/images/handle_LIST-eaf7cb36cd6f261db6c91508e7e0635a.png" width="400" height="539" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ida-tips--tricks">IDA tips &amp; tricks<a class="hash-link" href="#ida-tips--tricks" title="Direct link to heading">​</a></h3><ul><li>Saving progress is disabled for the trial version.
However, you can save a limited (but useful) subset of your work using <code>File -&gt; Produce File -&gt; Dump database to IDC file</code> and then load it next time using <code>File -&gt; Script File</code>.</li><li>If you close some windows and don&#x27;t know how to get them back you can reset the layout using <code>Windows-&gt;Reset Desktop</code>.</li><li>If you want to return to the previous view you can press <code>Escape</code>.</li><li>When you want to view code as in <code>objdump</code> you only need to press <code>Spacebar</code> once.
And then again to return to CFG mode.</li><li>If there is a hex value and you want to convert it to decimal (or back) press <code>h</code>.</li><li>Converting hex/dec values to <em>ASCII</em>: press <code>r</code>.</li><li>If you want to write comments next to an instruction or a function press <code>:</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ida-pro-and-ghidra">IDA Pro and Ghidra<a class="hash-link" href="#ida-pro-and-ghidra" title="Direct link to heading">​</a></h3><p>IDA Pro is installed on the Kali virtual machine.
The main difference between it and the free version is that the Pro one can also <strong>decompile</strong> the code based on the CFGs listed above.
This will come in extremely useful as we hack more and more binaries.</p><p>Another tool that is capable of decompiling the code in an executable is <a href="https://ghidra-sre.org/" target="_blank" rel="noopener noreferrer">Ghidra</a>.
One advantage of Ghidra over IDA is that Ghidra displays both the C and the Assembly code side by side.
This allows us to correlate the two and reap the benefits of both of them at the same time.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="c">C++<a class="hash-link" href="#c" title="Direct link to heading">​</a></h2><p>Things look slightly different when we try to hack executables that have been compiled from C++ code, instead of C.
The difference comes from the way symbols (method symbols in particular) are handled by C++ compilers.
Let&#x27;s disassemble the code below and see how its symbols look:</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">##include </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">iostream</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">using</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">namespace</span><span class="token plain"> std</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cout </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Hello world&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Disassembling it in IDA looks familiar at first</p><p><img loading="lazy" alt="IDA start" src="/binary-security/assets/images/ida_c++_start-e9f9ebb679d097cf91802b3850951f91.png" width="400" height="379" class="img_ev3q"></p><p>But then the fun starts:</p><p><img loading="lazy" alt="IDA main" src="/binary-security/assets/images/ida_c++_main-07869074429c34f45c71bade45f6c02d.png" width="550" height="343" class="img_ev3q"></p><p>As we can see, all symbols look almost as if they were encrypted.
In fact, this process is called <strong>name mangling</strong>.
If we take a closer look at them, however, we can distinguish some clues about those function calls, for example.
The first one contains the sequences <code>char_traits</code> and <code>basic_ostream</code>, the former being a C++ abstraction for string operations, while the latter is a base class for output operators, such as <code>&lt;&lt;</code>.</p><p>IDA can demangle strings such as the ones above by itself.
Some recommended settings (you may prefer something different) are the following:</p><ul><li><code>Options -&gt; Demangled names</code></li><li>Show demangled C++ names as <code>Names</code></li><li><code>Setup short names</code></li><li>Click <code>Only main name</code></li></ul><p>These settings only display the important classes and namespaces that make up each method, like this:</p><p><img loading="lazy" alt="IDA demangled" src="/binary-security/assets/images/ida_c++_demangled-849d03717ab1cd61335f6f35be59b9e6.png" width="521" height="416" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="further-reading">Further reading<a class="hash-link" href="#further-reading" title="Direct link to heading">​</a></h2><p>More information about name mangling can be obtained at:</p><ul><li><a href="https://en.wikipedia.org/wiki/Name_mangling" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Name_mangling</a></li><li>on demand demangling: <a href="http://demangler.com/" target="_blank" rel="noopener noreferrer">http://demangler.com/</a> or <code>c++filt</code></li></ul><p>You can find out more information about the internals of C++ in general, using the following references:</p><ul><li><a href="https://ocw.cs.pub.ro/courses/cpl/labs/06" target="_blank" rel="noopener noreferrer">https://ocw.cs.pub.ro/courses/cpl/labs/06</a> (in Romanian)</li><li><a href="https://www.blackhat.com/presentations/bh-dc-07/Sabanal_Yason/Paper/bh-dc-07-Sabanal_Yason-WP.pdf" target="_blank" rel="noopener noreferrer">https://www.blackhat.com/presentations/bh-dc-07/Sabanal_Yason/Paper/bh-dc-07-Sabanal_Yason-WP.pdf</a></li><li><a href="http://www.hexblog.com/wp-content/uploads/2011/08/Recon-2011-Skochinsky.pdf" target="_blank" rel="noopener noreferrer">http://www.hexblog.com/wp-content/uploads/2011/08/Recon-2011-Skochinsky.pdf</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="challenges">Challenges<a class="hash-link" href="#challenges" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="04-crypto_crackme">04. <code>crypto_crackme</code><a class="hash-link" href="#04-crypto_crackme" title="Direct link to heading">​</a></h3><p>The <code>crypto_crackme</code> binary is an application that asks for a secret and uses it to decrypt a message.
In order to solve this task, you have to retrieve the message.</p><ul><li>Open the binary using IDA and determine the program control flow.
What is it doing after fetching the secret?
It seems to be consuming a lot of CPU cycles.
If possible, use IDA to patch the program and reduce the execution time of the application.
Use <code>Edit -&gt; Patch program -&gt; Change byte...</code></li><li>Next, it looks like the program tries to verify if the secret provided is correct.
Where is the secret stored?
Is it stored in plain text?
Find out what the validation algorithm is.</li><li>Now break it and retrieve the message!</li></ul><p><strong>Important!</strong>:
Unfortunately, the virtual machine doesn&#x27;t support the <code>libssl1.0.0</code> version of <code>SSL</code> library.
Use the library files in the task archive and run the executable using:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">LD_LIBRARY_PATH=. ./crypto_crackme</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can break password hashes (including SHA1) on <a href="https://crackstation.net/" target="_blank" rel="noopener noreferrer"><code>CrackStation</code></a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="05-broken">05. broken<a class="hash-link" href="#05-broken" title="Direct link to heading">​</a></h3><p>The <code>broken</code> binary is asking you for the correct password.
Investigate the binary and provide it with the correct password.
If you provided the correct password the message <code>That&#x27;s correct! The password is &#x27;...&#x27;</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="06-hyp3rs3rv3r">06. <code>hyp3rs3rv3r</code><a class="hash-link" href="#06-hyp3rs3rv3r" title="Direct link to heading">​</a></h3><p>Investigate the <code>hyp3rs3rv3r</code> binary and find out where the backdoor function is.
Note that since it&#x27;s not directly called, IDA doesn&#x27;t think of it as a procedure, so it won&#x27;t come up on the left pane.
Figure out a way around this.
When you find that code block you can press <code>p</code> on the first instruction to help IDA see it as a procedure.</p><p><strong>Hint</strong>:
In order to exploit the vulnerability in Ubuntu, you should use <code>netcat-traditional</code>.
You can switch from <code>netcat-openbsd</code> to <code>netcat-traditional</code> using the steps described <a href="https://stackoverflow.com/questions/10065993/how-to-switch-to-netcat-traditional-in-ubuntu" target="_blank" rel="noopener noreferrer">here</a>.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/binary-security/Binary Analysis/Static Analysis/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Static Analysis</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/binary-security/Binary Analysis/Static Analysis/Drills/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Drills</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#disassembling-executables" class="table-of-contents__link toc-highlight">Disassembling Executables</a><ul><li><a href="#linear-sweep" class="table-of-contents__link toc-highlight">Linear Sweep</a></li><li><a href="#recursive-traversal" class="table-of-contents__link toc-highlight">Recursive Traversal</a></li></ul></li><li><a href="#ida-and-ghidra" class="table-of-contents__link toc-highlight">IDA and Ghidra</a><ul><li><a href="#ida-tips--tricks" class="table-of-contents__link toc-highlight">IDA tips &amp; tricks</a></li><li><a href="#ida-pro-and-ghidra" class="table-of-contents__link toc-highlight">IDA Pro and Ghidra</a></li></ul></li><li><a href="#c" class="table-of-contents__link toc-highlight">C++</a></li><li><a href="#further-reading" class="table-of-contents__link toc-highlight">Further reading</a></li><li><a href="#challenges" class="table-of-contents__link toc-highlight">Challenges</a><ul><li><a href="#04-crypto_crackme" class="table-of-contents__link toc-highlight">04. <code>crypto_crackme</code></a></li><li><a href="#05-broken" class="table-of-contents__link toc-highlight">05. broken</a></li><li><a href="#06-hyp3rs3rv3r" class="table-of-contents__link toc-highlight">06. <code>hyp3rs3rv3r</code></a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://security-summer-school.github.io/binary/" target="_blank" rel="noopener noreferrer" class="footer__link-item">site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/SSSUPB/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 SSS Team</div></div></div></footer></div>
<script src="/binary-security/assets/js/runtime~main.74200969.js"></script>
<script src="/binary-security/assets/js/main.d9be8505.js"></script>
</body>
</html>