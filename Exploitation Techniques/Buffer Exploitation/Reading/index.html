<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Exploitation Techniques/Buffer Exploitation/Reading/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Buffer Exploitation | Binary Security</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://open-education-hub.github.io/binary-security/Exploitation Techniques/Buffer Exploitation/Reading/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Buffer Exploitation | Binary Security"><meta data-rh="true" name="description" content="Pwntools"><meta data-rh="true" property="og:description" content="Pwntools"><link data-rh="true" rel="canonical" href="http://open-education-hub.github.io/binary-security/Exploitation Techniques/Buffer Exploitation/Reading/"><link data-rh="true" rel="alternate" href="http://open-education-hub.github.io/binary-security/Exploitation Techniques/Buffer Exploitation/Reading/" hreflang="en"><link data-rh="true" rel="alternate" href="http://open-education-hub.github.io/binary-security/Exploitation Techniques/Buffer Exploitation/Reading/" hreflang="x-default"><link rel="stylesheet" href="/binary-security/assets/css/styles.a69a9d41.css">
<link rel="preload" href="/binary-security/assets/js/runtime~main.74200969.js" as="script">
<link rel="preload" href="/binary-security/assets/js/main.d9be8505.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/binary-security/"><div class="navbar__logo"><img src="/binary-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/binary-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Binary Security</b></a><a class="navbar__item navbar__link" href="/binary-security/Binary Analysis">Binary Analysis</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/binary-security/Exploitation Techniques">Exploitation Techniques</a><a class="navbar__item navbar__link" href="/binary-security/Mitigation and Defensive Strategies">Mitigation and Defensive Strategies</a><a class="navbar__item navbar__link" href="/binary-security/Extra">Extra</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/binary-security/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/binary-security/Binary Analysis/">Binary Analysis</a><button aria-label="Toggle the collapsible sidebar category &#x27;Binary Analysis&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/binary-security/Exploitation Techniques/">Exploitation Techniques</a><button aria-label="Toggle the collapsible sidebar category &#x27;Exploitation Techniques&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/binary-security/Exploitation Techniques/Buffer Exploitation/">Buffer Exploitation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Buffer Exploitation&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/binary-security/Exploitation Techniques/Buffer Exploitation/Reading/">Reading</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/binary-security/Exploitation Techniques/Shellcodes/">Shellcodes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Shellcodes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/binary-security/Exploitation Techniques/Shellcodes Advanced/">Shellcodes Advanced</a><button aria-label="Toggle the collapsible sidebar category &#x27;Shellcodes Advanced&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/binary-security/Exploitation Techniques/Return-Oriented Programming/">Return-Oriented Programming</a><button aria-label="Toggle the collapsible sidebar category &#x27;Return-Oriented Programming&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/binary-security/Exploitation Techniques/Return-Oriented Programming Advanced/">Return-Oriented Programming Advanced</a><button aria-label="Toggle the collapsible sidebar category &#x27;Return-Oriented Programming Advanced&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/binary-security/Mitigation and Defensive Strategies/">Mitigation and Defensive Strategies</a><button aria-label="Toggle the collapsible sidebar category &#x27;Mitigation and Defensive Strategies&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/binary-security/Extra/">Extra</a><button aria-label="Toggle the collapsible sidebar category &#x27;Extra&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/binary-security/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/binary-security/Exploitation Techniques/"><span itemprop="name">Exploitation Techniques</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/binary-security/Exploitation Techniques/Buffer Exploitation/"><span itemprop="name">Buffer Exploitation</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Reading</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Buffer Exploitation</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pwntools">Pwntools<a class="hash-link" href="#pwntools" title="Direct link to heading">​</a></h2><p>In this lab we will be using the <code>pwntools</code> python module to solve the tasks.
Check out the <a href="/binary-security/Extra/Pwntool Intro/Reading"><code>Pwntools</code> Tutorial section</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="buffers">Buffers<a class="hash-link" href="#buffers" title="Direct link to heading">​</a></h2><p>A buffer is an area of contiguous data in memory, determined by a starting address, contents and length.
Understanding how buffers are used (or misused) is vital for both offensive and defensive purposes.
In C, we can declare a buffer of bytes as a char array, as follows:</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> local_buffer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Which results in the following assembly code:</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">push   rbp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov    rbp,rsp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sub    rsp,0x20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ret</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Notice that buffer allocation is done by simply subtracting its intended size from the current stack pointer (<code>sub rsp, 0x20</code>).
This simply reserves space on the stack (remember that on x86 the stack grows “upwards”, from higher addresses to lower ones).</p><p>A compiler may allocate more space on the stack than explicitly required due to alignment constraints or other hidden values.
To exploit a program, the C source code may not be a good enough reference point for stack offsets.
Only disassembling the executable will provide relevant information.</p><p>Buffers can be also be stored in other places in memory, such as the heap, <code>.bss</code>, <code>.data</code> or <code>.rodata</code>.</p><p>Analyze and compile the following snippet (also present in the lab files, go to <code>00-tutorial</code> and run <code>make buffers</code>):</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> g_buf_init_zero</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/* g_buf_init_vals[5..31] will be 0 */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> g_buf_init_vals</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> g_buf_const</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Hello, world\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> l_buf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> s_l_buf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">heap_buf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">malloc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">free</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">heap_buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Check the common binary sections and symbols.
Use the usual commands (<code>readelf -S</code>, <code>nm</code>).
Observe in which section each variable is located and the section flags.</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ readelf -S buffers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [16] .rodata           PROGBITS         &lt;b&gt;0000000000402000&lt;/b&gt;  00002000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       0000000000000040  0000000000000000   &lt;b&gt;A&lt;/b&gt;       0     0     32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [24] .data             PROGBITS         &lt;b&gt;0000000000404040&lt;/b&gt;  00003040</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       0000000000000040  0000000000000000  &lt;b&gt;WA&lt;/b&gt;       0     0     32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [25] .bss              NOBITS           &lt;b&gt;0000000000404080&lt;/b&gt;  00003080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       0000000000000060  0000000000000000  &lt;b&gt;WA&lt;/b&gt;       0     0     32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Key to Flags:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  W (write), A (alloc), X (execute)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ nm buffers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;b&gt;0000000000402020 R&lt;/b&gt; g_buf_const</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;b&gt;0000000000404060 D&lt;/b&gt; g_buf_init_vals</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;b&gt;00000000004040a0 B&lt;/b&gt; g_buf_init_zero</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Key to Flags:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  R (symbol is read-only)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  D (symbol in initialized data section)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  B (symbol in BSS data section)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  A lowercase flag means variable is not visible local (not visible outside the object)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can also inspect these programmatically using pwntools and the ELF class:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pwn </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">elf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ELF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;buffers&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bss    </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> elf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_section_by_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;.bss&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> elf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_section_by_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;.data&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rodata </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> elf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_section_by_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;.rodata&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bss_addr    </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bss</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;sh_addr&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_addr   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;sh_addr&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rodata_addr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> rodata</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;sh_addr&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bss_size </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bss</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;sh_size&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_size </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;sh_size&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rodata_size </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> rodata</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;sh_size&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># A (Alloc) = 1 &lt;&lt; 1 = 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># W (Write) = 1 &lt;&lt; 0 = 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bss_flags    </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bss</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;sh_flags&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_flags   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;sh_flags&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rodata_flags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> rodata</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;sh_flags&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Section info:&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;.bss:    0x{:08x}-0x{:08x}, {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bss_addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bss_addr</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">bss_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> bss_flags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;.data:   0x{:08x}-0x{:08x}, {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data_addr</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">data_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data_flags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;.rodata: 0x{:08x}-0x{:08x}, {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rodata_addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rodata_addr</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">rodata_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rodata_flags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Variable info:&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;g_buf_init_zero: 0x{:08x}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">elf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">symbols</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">g_buf_init_zero</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;g_buf_init_vals: 0x{:08x}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">elf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">symbols</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">g_buf_init_vals</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;g_buf_const:     0x{:08x}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">elf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">symbols</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">g_buf_const</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Another handy utility is the <code>vmmap</code> command in <code>pwndbg</code> which shows all memory maps of the process at runtime:</p><div class="language-gdb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-gdb codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; b main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwngdb&gt; run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; vmmap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          0x400000           0x401000 r--p     1000 0      /home/user/buffers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          0x401000           0x402000 r-xp     1000 1000   /home/user/buffers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          0x402000           0x403000 r--p     1000 2000   /home/user/buffers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          0x403000           0x404000 r--p     1000 2000   /home/user/buffers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          0x404000           0x405000 rw-p     1000 3000   /home/user/buffers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    0x7ffff7dc9000     0x7ffff7dcb000 rw-p     2000 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    0x7ffffffdd000     0x7ffffffff000 rw-p    22000 0      [stack]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xffffffffff600000 0xffffffffff601000 --xp     1000 0      [vsyscall]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Non-static local variables and dynamically allocated buffers cannot be seen in the executable (they have meaning only at runtime, because they are allocated on the stack or heap in a function scope).
The symbol names aren&#x27;t found anywhere in the binary, except if debug symbols are enabled (<code>-g</code> flag).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="stack-buffer-overflow">Stack Buffer Overflow<a class="hash-link" href="#stack-buffer-overflow" title="Direct link to heading">​</a></h2><p><img loading="lazy" alt="Stack Overflow" src="/binary-security/assets/images/stack_x86_64-c927f7ec64beb301fa5e4f41e8ef048b.png" width="791" height="416" class="img_ev3q"></p><p>Note that this is the stack for a 64bit system and the first couple of function arguments are stored in registers (<code>rdi</code>, <code>rsi</code>, <code>rdx</code>, <code>rcx</code>, <code>r8</code>, and <code>r9</code>) and that&#x27;s why the images has <code>arg_6</code> as the first argument.</p><p>We should know by now that the stack serves multiple purposes:</p><ul><li>Passing function arguments from the caller to the callee</li><li>Storing local variables for functions</li><li>Temporarily saving register values before a call</li><li>Saving the return address and old frame pointer</li></ul><p>Even though, in an abstract sense, different buffers are separate from one another, ultimately they are just some regions of memory which do not have any intrinsic identification or associated size.
To avoid this, most high level languages use size metadata and bound checks to detect out of bounds accesses to the memory.</p><p>But in our case, bounds are unchecked, therefore it is up to the programmer to code carefully.
This includes checking for any overflows and using <strong>safe functions</strong>.
Unfortunately, many functions in the standard C library, particularly those which work with strings and read user input, are unsafe - nowadays, the compiler will issue warnings when encountering them.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="buffer-size-and-offset-identification">Buffer Size and Offset Identification<a class="hash-link" href="#buffer-size-and-offset-identification" title="Direct link to heading">​</a></h3><p>When trying to overflow a buffer on the stack we need to know the size and where the buffer is in memory relative to the saved return address (or some other control flow altering value/pointer).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="static-analysis">Static Analysis<a class="hash-link" href="#static-analysis" title="Direct link to heading">​</a></h4><p>One way, for simple programs, you can do <strong>static analysis</strong> and check some key points in the disassembled code.</p><p>For example, this simple program (<code>00-tutorial/simple_read</code>, run <code>make simple_read</code> to compile):</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> buf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">128</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fread</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">stdin</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>generates the following assembly code:</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">push   rbp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov    rbp,rsp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sub    rsp,0x90</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov    rax,QWORD PTR fs:0x28</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov    QWORD PTR [rbp-0x8],rax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xor    eax,eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># important bit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov    rdx,QWORD PTR [rip+0x2ed6]        # 4040 &lt;stdin@@GLIBC_2.2.5&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lea    rax,[rbp-0x90]                    # &lt;- stack buffer starts at rbp-0x90</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov    rcx,rdx                           # &lt;- 4th argument fo fread, stdin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov    edx,0x100                         # &lt;- 3rd argument of fread, number of elements read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov    esi,0x1                           # &lt;- 2nd argument of fread, size of element</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov    rdi,rax                           # &lt;- 1st argument of fread (buffer address saved in RAX)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">call   1030 &lt;fread@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">push   rbp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov    rbp,rsp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">add    rsp,0xffffffffffffff80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># --- important bit ---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov    rdx,QWORD PTR [rip+0x2efb]        # 404030 &lt;stdin@@GLIBC_2.2.5&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lea    rax,[rbp-0x80]  # &lt;- stack buffer starts at rbp-0x80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov    rcx,rdx         # &lt;- 4th argument fo fread, stdin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov    edx,0x100       # &lt;- 3rd argument of fread, number of elements read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov    esi,0x1         # &lt;- 2nd argument of fread, size of element</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov    rdi,rax         # &lt;- 1st argument of fread (buffer address saved in RAX)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">call   401030 &lt;fread@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ---------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov    eax,0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">leave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ret</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Looking at the <code>fread</code> arguments we can see the buffer start relative to <code>RBP</code> and the number of bytes read.
<code>RBP-0x80+0x100*0x1 = RBP+0x80</code>, so the <code>fread</code> function can read 128 bytes after <code>RBP</code> -&gt; return address stored at 136 bytes after <code>RBP</code>.</p><p><img loading="lazy" alt="Stack Buffer" src="/binary-security/assets/images/stack_buffer-0b96391d4eed9498228a407c79df21e7.png" width="791" height="416" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="dynamic-analysis">Dynamic Analysis<a class="hash-link" href="#dynamic-analysis" title="Direct link to heading">​</a></h4><p>You can determine offsets at runtime in a more automated way with pwndbg using an <a href="https://en.wikipedia.org/wiki/De_Bruijn_sequence" target="_blank" rel="noopener noreferrer">De Bruijn sequences</a> which produces strings where every substring of length N appears only once in the sequence;
in our case it helps us identify the offset of an exploitable memory value relative to the buffer.</p><p>For a simple buffer overflow the workflow is:</p><ol><li>generate an long enough sequence to guarantee a buffer overflow</li><li>feed the generated sequence to the input function in the program</li><li>the program will produce a segmentation fault when reaching the invalid return address on the stack</li><li>search the offset of the faulty address in the generated pattern to get an offset</li></ol><p>In pwndbg this works as such:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; cyclic -n 8 256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaaaaaanaaaaaaaoaaaaaaapaaaaaaaqaaaaaaaraaaaaaasaaaaaaataaaaaaauaaaaaaavaaaaaaawaaaaaaaxaaaaaaayaaaaaaazaaaaaabbaaaaaabcaaaaaabdaaaaaabeaaaaaabfaaaaaabgaaaaaab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;reading input, paste the generated pattern&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; continue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Program received signal SIGSEGV, Segmentation fault</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x401141 &lt;main+27&gt;    mov    esi, 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x401146 &lt;main+32&gt;    mov    rdi, rax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x401149 &lt;main+35&gt;    call   fread@plt &lt;fread@plt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x40114e &lt;main+40&gt;    mov    eax, 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x401153 &lt;main+45&gt;    leave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ► 0x401154 &lt;main+46&gt;    ret    &lt;0x6161616161616172&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; cyclic -n 8 -c 64 -l 0x6161616161616172</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">136</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Note</strong>:
We get the same 136 offset computed manually with the static analysis method.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="input-output-functions">Input-Output Functions<a class="hash-link" href="#input-output-functions" title="Direct link to heading">​</a></h2><p>Most programs aren&#x27;t a straight forward single input buffer overflow so we need to deal with things like:</p><ul><li>automating program input-output - by programmatically sending and receiving data</li><li>parsing program output - to use potential leaked information</li><li>understand the mechanics of the IO methods used - what kind of data they accept and possible constraints</li></ul><p><code>pwntools</code> offers a large area of <a href="https://docs.pwntools.com/en/stable/tubes.html" target="_blank" rel="noopener noreferrer">IO functions</a> to communicate with a program (either local or remote).
The basic and usual ones are:</p><ul><li><code>send(data)</code> - sends the <code>data</code> byte string to the process</li><li><code>sendline(data)</code> - shorthand for <code>send(data + b&quot;\n&quot;)</code></li><li><code>recv(num)</code> - receives <code>num</code> bytes from the process</li><li><code>recvline()</code> - receives a whole line from the process (until &#x27;\n&#x27;)</li><li><code>recvuntil(str)</code> - receives data until <code>str</code> is found (will not contain <code>str</code>)</li><li><code>recvall()</code> - receives the full program output (until <code>EOF</code>)</li></ul><p>Check the documentation for more complex IO functions that might come in handy (like <code>recvregex</code>, <code>sendafter</code>).</p><p>It is also important to understand the functionality of the different IO functions the program itself uses.
For C programs, in our case, you can always
find useful information in the man pages of specific functions:</p><ul><li><code>size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream)</code>:
Reads <code>nmemb</code> items of data, each <code>size</code> bytes long, simple and straightforward.</li><li><code>char *gets(char *s)</code>:
Reads until either a terminating newline or <code>EOF</code>, which it replaces with a null byte (&#x27;\0&#x27;).
The problem here is that you won&#x27;t be able to have a newline in the middle of your payload;
note that it doesn&#x27;t have a size argument to it will read indefinitely as long as it doesn&#x27;t reach a newline or <code>EOF</code>.</li><li><code>char *fgets(char *s, int size, FILE *stream)</code>:
Reads in <strong>at most</strong> one less than <code>size</code> characters from stream and stores them into the buffer pointed to by s.
Reading stops after an <code>EOF</code> or a <strong>newline</strong>.
If a <strong>newline</strong> is read, it is stored into the buffer.
A terminating null byte (&#x27;\0&#x27;) is stored after the last character in the buffer.
This one adds the size limit argument, but also note that it <strong>stores</strong> the newline in the string and <strong>adds</strong> the null byte after (in contrast to <code>gets</code>)</li><li><code>int scanf(const char *format, ...)</code>:
As opposed the other functions <code>scanf</code> reads <strong>text</strong> based on the format string and parses it
Don&#x27;t do the common mistake of <strong>sending binary data to <code>scanf</code></strong>, for example <code>&quot;%d&quot;</code> expects a string representation of a number like <code>&quot;16&quot;</code>, not the binary data like <code>&quot;\x00\x00\x00\x10&quot;</code></li></ul><p>Every time you encounter a new input function check the documentation to find it&#x27;s limitations</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="challenges">Challenges<a class="hash-link" href="#challenges" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="01-challenge-parrot">01. Challenge: Parrot<a class="hash-link" href="#01-challenge-parrot" title="Direct link to heading">​</a></h3><p>Some programs feature a stack smashing protection in the form of stack canaries, that is, values kept on the stack which are checked before returning from a function.
If the value has changed, then the “canary” can conclude that stack data has been corrupted throughout the execution of the current function.</p><p>We have implemented our very own <code>parrot</code>.
Can you avoid it somehow?</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="02-challenge-indexing">02. Challenge: Indexing<a class="hash-link" href="#02-challenge-indexing" title="Direct link to heading">​</a></h3><p>More complex programs require some form of protocol or user interaction.
This is where <code>pwntools</code> shines.
Here&#x27;s an interactive script to get you started:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">#!/usr/bin/env python</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pwn </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;./indexing&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recvuntil</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Index: &#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># TODO (must be string)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Give value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recvuntil</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Value: &#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># TODO (must be string)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">interactive</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Go through GDB when aiming to solve this challenge.
As all input values are strings, you can input them at the keyboard and follow their effect in GDB.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="03-challenge-smashthestack-level7">03. Challenge: <code>smashthestack</code> <code>Level7</code><a class="hash-link" href="#03-challenge-smashthestack-level7" title="Direct link to heading">​</a></h3><p>Now you can tackle a real challenge.
See if you can figure out how you can get a shell from this one.</p><p>Hints:</p><ul><li>There&#x27;s an integer overflow + buffer overflow in the program.</li><li>How does integer multiplication work at a low level?
Can you get a positive number by multiplying a negative number by 4?</li><li>To pass command-line arguments in gdb use <code>run arg1 arg2 ...</code> or <code>set args arg1 arg2 ...</code> before a <code>run</code> command</li><li>In <code>pwntools</code> you can pass a list to <code>process</code> (<code>process([&#x27;./level07&#x27;, arg1, arg2]</code>)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="04-challenge-neighbourly">04. Challenge: Neighbourly<a class="hash-link" href="#04-challenge-neighbourly" title="Direct link to heading">​</a></h3><p>Let&#x27;s overwrite a structure&#x27;s function pointer using a buffer overflow in its vicinity.
The principle is the same.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="05-challenge-input-functions">05. Challenge: Input Functions<a class="hash-link" href="#05-challenge-input-functions" title="Direct link to heading">​</a></h3><p>On the same idea as the &quot;Indexing&quot; challenge but much harder.
Carefully check what input functions are used and parse the input accordingly.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="06-challenge-bonus-birds">06. Challenge: Bonus: Birds<a class="hash-link" href="#06-challenge-bonus-birds" title="Direct link to heading">​</a></h3><p>Time for a more complex challenge.
Be patient and don&#x27;t speed through it.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="further-reading">Further Reading<a class="hash-link" href="#further-reading" title="Direct link to heading">​</a></h2><ul><li><a href="https://en.wikipedia.org/wiki/De_Bruijn_sequence" target="_blank" rel="noopener noreferrer">De Bruijn sequences</a></li><li><a href="https://docs.pwntools.com/en/latest/elf/elf.html" target="_blank" rel="noopener noreferrer"><code>PwnTools</code> <code>ELF</code> Module</a> (which internally uses <a href="https://github.com/eliben/pyelftools" target="_blank" rel="noopener noreferrer"><code>PyElftoools</code></a> and may expose such objects)</li><li><a href="https://docs.pwntools.com/en/stable/tubes.html" target="_blank" rel="noopener noreferrer"><code>PwnTools</code> <code>IO</code></a></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/binary-security/Exploitation Techniques/Buffer Exploitation/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Buffer Exploitation</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/binary-security/Exploitation Techniques/Shellcodes/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Shellcodes</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#pwntools" class="table-of-contents__link toc-highlight">Pwntools</a></li><li><a href="#buffers" class="table-of-contents__link toc-highlight">Buffers</a></li><li><a href="#stack-buffer-overflow" class="table-of-contents__link toc-highlight">Stack Buffer Overflow</a><ul><li><a href="#buffer-size-and-offset-identification" class="table-of-contents__link toc-highlight">Buffer Size and Offset Identification</a></li></ul></li><li><a href="#input-output-functions" class="table-of-contents__link toc-highlight">Input-Output Functions</a></li><li><a href="#challenges" class="table-of-contents__link toc-highlight">Challenges</a><ul><li><a href="#01-challenge-parrot" class="table-of-contents__link toc-highlight">01. Challenge: Parrot</a></li><li><a href="#02-challenge-indexing" class="table-of-contents__link toc-highlight">02. Challenge: Indexing</a></li><li><a href="#03-challenge-smashthestack-level7" class="table-of-contents__link toc-highlight">03. Challenge: <code>smashthestack</code> <code>Level7</code></a></li><li><a href="#04-challenge-neighbourly" class="table-of-contents__link toc-highlight">04. Challenge: Neighbourly</a></li><li><a href="#05-challenge-input-functions" class="table-of-contents__link toc-highlight">05. Challenge: Input Functions</a></li><li><a href="#06-challenge-bonus-birds" class="table-of-contents__link toc-highlight">06. Challenge: Bonus: Birds</a></li></ul></li><li><a href="#further-reading" class="table-of-contents__link toc-highlight">Further Reading</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://security-summer-school.github.io/binary/" target="_blank" rel="noopener noreferrer" class="footer__link-item">site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/SSSUPB/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 SSS Team</div></div></div></footer></div>
<script src="/binary-security/assets/js/runtime~main.74200969.js"></script>
<script src="/binary-security/assets/js/main.d9be8505.js"></script>
</body>
</html>