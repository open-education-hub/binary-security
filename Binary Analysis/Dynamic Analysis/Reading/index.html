<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Binary Analysis/Dynamic Analysis/Reading/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Dynamic Analysis | Binary Security</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://open-education-hub.github.io/binary-security/Binary Analysis/Dynamic Analysis/Reading/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Dynamic Analysis | Binary Security"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="canonical" href="http://open-education-hub.github.io/binary-security/Binary Analysis/Dynamic Analysis/Reading/"><link data-rh="true" rel="alternate" href="http://open-education-hub.github.io/binary-security/Binary Analysis/Dynamic Analysis/Reading/" hreflang="en"><link data-rh="true" rel="alternate" href="http://open-education-hub.github.io/binary-security/Binary Analysis/Dynamic Analysis/Reading/" hreflang="x-default"><link rel="stylesheet" href="/binary-security/assets/css/styles.49519274.css">
<link rel="preload" href="/binary-security/assets/js/runtime~main.2a371c1c.js" as="script">
<link rel="preload" href="/binary-security/assets/js/main.a3ed9e3a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/binary-security/"><div class="navbar__logo"><img src="/binary-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/binary-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Binary Security</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/binary-security/Binary Analysis">Binary Analysis</a><a class="navbar__item navbar__link" href="/binary-security/Exploitation Techniques">Exploitation Techniques</a><a class="navbar__item navbar__link" href="/binary-security/Mitigation and Defensive Strategies">Mitigation and Defensive Strategies</a><a class="navbar__item navbar__link" href="/binary-security/Extra">Extra</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/binary-security/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/binary-security/Binary Analysis/">Binary Analysis</a><button aria-label="Toggle the collapsible sidebar category &#x27;Binary Analysis&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/binary-security/Binary Analysis/Exploration Tools/">Exploration Tools</a><button aria-label="Toggle the collapsible sidebar category &#x27;Exploration Tools&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/binary-security/Binary Analysis/Executables and Processes/">Executables and Processes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Executables and Processes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/binary-security/Binary Analysis/Static Analysis/">Static Analysis</a><button aria-label="Toggle the collapsible sidebar category &#x27;Static Analysis&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/binary-security/Binary Analysis/Dynamic Analysis/">Dynamic Analysis</a><button aria-label="Toggle the collapsible sidebar category &#x27;Dynamic Analysis&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/binary-security/Binary Analysis/Dynamic Analysis/Reading/">Reading</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/binary-security/Binary Analysis/Dynamic Analysis/Dynamic-Analysis">Slides</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/binary-security/Exploitation Techniques/">Exploitation Techniques</a><button aria-label="Toggle the collapsible sidebar category &#x27;Exploitation Techniques&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/binary-security/Mitigation and Defensive Strategies/">Mitigation and Defensive Strategies</a><button aria-label="Toggle the collapsible sidebar category &#x27;Mitigation and Defensive Strategies&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/binary-security/Extra/">Extra</a><button aria-label="Toggle the collapsible sidebar category &#x27;Extra&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/binary-security/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/binary-security/Binary Analysis/"><span itemprop="name">Binary Analysis</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/binary-security/Binary Analysis/Dynamic Analysis/"><span itemprop="name">Dynamic Analysis</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Reading</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Dynamic Analysis</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="objectives--rationale">Objectives &amp; Rationale<a class="hash-link" href="#objectives--rationale" title="Direct link to heading">​</a></h3><p>The first part of this session will give you a walkthrough of the most common GDB principles that we are going to use in exploitation.
In the second half, we are going to use these concepts in practice, to evade a basic key evaluation program.</p><p>Black Box type analysis works best when standard algorithms are used in the program, such as: <code>MD5</code>, <code>SHA1</code>, <code>RSA</code>.
We can change the input to a more suggestive one and use the output to estimate what function was used to convert it.</p><p>Combined with behavioral analysis methods such as using sandboxes or strace/ltrace we can quickly map sections of code to functionalities.</p><p>With dynamic analysis, packed malware can be extracted from memory in unpacked form, enabling us to continue static analysis on the complete binary.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">​</a></h3><p>In the current session we will use GDB extensively.
We assume that you are familiar with its basic usage and will move on quickly to some of its more advanced features.</p><p>To brush up on the GDB basics, read this <a href="https://security.cs.pub.ro/summer-school/wiki/session/04-gdb" target="_blank" rel="noopener noreferrer" title="session:04-gdb">Refresher</a>.</p><p>The executable used in the demo is called <code>sppb</code> and is the challenge 1 binary.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="before-gdb">Before GDB<a class="hash-link" href="#before-gdb" title="Direct link to heading">​</a></h3><p>One thing you should always do before firing up GDB is to try to learn all the available information on the executable you&#x27;re trying to debug through the techniques that have been presented so far.</p><p>For the purposes of this session it is a good idea to always run<code>objdump</code> on all the executable files before attaching GDB to them so that you have a better idea of what goes where.</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">objdump -M intel -d [executable]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="gdb-basic-commands">GDB Basic Commands<a class="hash-link" href="#gdb-basic-commands" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-help-with-gdb">Getting help with GDB<a class="hash-link" href="#getting-help-with-gdb" title="Direct link to heading">​</a></h3><p>Whenever you want to find out more information about GDB commands feel free to search for it inside <a href="http://www.gnu.org/software/gdb/documentation/" target="_blank" rel="noopener noreferrer" title="http://www.gnu.org/software/gdb/documentation/">the documentation</a> or by using the <code>help</code> command followed by your area of interest.
For example searching for help for the <code>disassemble</code> command can be obtained by running the following command in GDB:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Print info about all help areas available.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Identify the area of your question.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) help</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Print info about available data commands.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Identify the command you want to learn more about.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) help data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Print info about a specific command.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Find out more about the command you are searching for.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) help disassemble</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="opening-a-program-with-gdb">Opening a program with GDB<a class="hash-link" href="#opening-a-program-with-gdb" title="Direct link to heading">​</a></h3><p>A program can be opened for debugging in a number of ways.
We can run GDB directly attaching it to a program:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gdb [executable-file]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Or we can open up GDB and then specify the program we are trying to attach to using the file or file-exec command:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ gdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) file [executable-file]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Furthermore we can attach GDB to a running service if we know its process id:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gdb --pid [pid_number]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="disassembling">Disassembling<a class="hash-link" href="#disassembling" title="Direct link to heading">​</a></h3><p>GDB allows disassembling of binary code using the <code>disassemble</code> command
(it may be shortened to <code>disas</code>).
The command can be issued either on a
memory address or using labels.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) disassemble *main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dump of assembler code for function main:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491c9 &lt;+0&gt;:     push   ebp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491ca &lt;+1&gt;:     mov    ebp,esp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491cc &lt;+3&gt;:     push   ebx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491cd &lt;+4&gt;:     sub    esp,0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=&gt; 0x080491d0 &lt;+7&gt;:     mov    eax,ds:0x804c030</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">....Output ommited.....</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) disassemble 0x080491c9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dump of assembler code for function main:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491c9 &lt;+0&gt;:     push   ebp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491ca &lt;+1&gt;:     mov    ebp,esp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491cc &lt;+3&gt;:     push   ebx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491cd &lt;+4&gt;:     sub    esp,0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=&gt; 0x080491d0 &lt;+7&gt;:     mov    eax,ds:0x804c030</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="adding-breakpoints">Adding Breakpoints<a class="hash-link" href="#adding-breakpoints" title="Direct link to heading">​</a></h3><p>Breakpoints are important to suspend the execution of the program being debugged in a certain place.
Adding breakpoints is done with the <code>break</code> command.
A good idea is to place a breakpoint at the main function of the program you are trying to exploit.
Given the fact that you have already run <code>objdump</code> and disassembled the program you know the address for the start of the main function.
This means that we can set a breakpoint for the start of our program in two ways:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) break *main (when the binary is not stripped of symbols)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) break *0x[main_address_obtained_with_objdump] (when aslr is off)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The general format for setting breakpoints in GDB is as follows:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) break [LOCATION] [thread THREADNUM] [if CONDITION]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Issuing the <code>break</code> command with no parameters will place a breakpoint at the current address.
GDB allows using abbreviated forms for all the commands it supports.
Learning these abbreviations comes with time and will greatly improve you work output.
Always be on the lookout for using abbreviated commands</p><p>The abbreviated command for setting breakpoints is simply <code>b</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="listing-breakpoints">Listing Breakpoints<a class="hash-link" href="#listing-breakpoints" title="Direct link to heading">​</a></h3><p>At any given time all the breakpoints in the program can be displayed using the <code>info breakpoints</code> command:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) info breakpoints</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can also issue the abbreviated form of the command</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) i b</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="deleting-breakpoints">Deleting Breakpoints<a class="hash-link" href="#deleting-breakpoints" title="Direct link to heading">​</a></h3><p>Breakpoints can be removed by issuing the <code>delete breakpoints</code> command followed by the breakpoints number, as it is listed in the output of the
<code>info breakpoints</code> command.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) delete breakpoints [breakpoint_number]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can also delete all active breakpoints by issuing the following the <code>delete breakpoints</code> command with no parameters:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) delete breakpoints</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once a breakpoint is set you would normally want to launch the program into execution.
You can do this by issuing the <code>run</code> command.
The program will start executing and stop at the first breakpoint you have set.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="execution-flow">Execution Flow<a class="hash-link" href="#execution-flow" title="Direct link to heading">​</a></h4><p>Execution flow can be controlled in GDB using the <code>continue</code>, <code>stepi</code>,<code>nexti</code> as follows:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) help continue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Continue program being debugged, after signal or breakpoint.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># If proceeding from breakpoint, a number N may be used as an argument,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># which means to set the ignore count of that breakpoint to N - 1 (so that the breakpoint won&#x27;t break until the Nth time it is reached).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) help stepi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step one instruction exactly.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Argument N means do this N times (or till program stops for another reason).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) help nexti</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Step one instruction, but proceed through subroutine calls.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Argument N means do this N times (or till program stops for another reason).</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can also use the abbreviated format of the commands: <code>c</code> (<code>continue</code>), <code>si</code> (<code>stepi</code>), <code>ni</code> (<code>nexti</code>).</p><p>If at any point you want to start the program execution from the beginning you can always reissue the <code>run</code> command.</p><p>Another technique that can be used for setting breakpoints is using offsets.</p><p>As you already know, each assembly instruction takes a certain number of bytes inside the executable file.
This means that whenever you are setting breakpoints using offsets you must always set them at instruction boundaries.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) break *main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Breakpoint 1 at 0x80491d0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting program: sppb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Breakpoint 1, 0x80491d0 in main ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) disassemble main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dump of assembler code for function main:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491c9 &lt;+0&gt;:     push   ebp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491ca &lt;+1&gt;:     mov    ebp,esp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491cc &lt;+3&gt;:     push   ebx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491cd &lt;+4&gt;:     sub    esp,0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.....Output ommited.....</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) break *main+4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Breakpoint 2 at 0x80491cd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="examine-and-print-your-most-powerful-tools">Examine and Print, Your Most Powerful Tools<a class="hash-link" href="#examine-and-print-your-most-powerful-tools" title="Direct link to heading">​</a></h3><p>GDB allows examining of memory locations be them specified as addresses or stored in registers.
The <code>x</code> command (for <em>examine</em>) is arguably one of the most powerful tool in your arsenal and the most common command you are going to run when exploiting.
The format for the <code>examine</code> command is as follows:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) x/nfu [address]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        n:  How many units to print</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        f:  Format character</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              a Pointer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              c Read as integer, print as character</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              d Integer, signed decimal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              f Floating point number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              o Integer, print as octal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              s Treat as C string (read all successive memory addresses until null character and print as characters)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              t Integer, print as binary (t=&quot;two&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              u Integer, unsigned decimal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              x Integer, print as hexadecimal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        u:  Unit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              b: Byte</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              h: Half-word (2 bytes)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              w: Word (4 bytes)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              g: Giant word (8 bytes)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              i: Instruction (read n assembly instructions from the specified memory address)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In contrast with the examine command, which reads data at a memory location the <code>print</code> command (shorthand <code>p</code>) prints out values stored in registers and variables.
The format for the <code>print</code> command is as follows:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) p/f [what]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        f:  Format character</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              a Pointer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              c Read as integer, print as character</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              d Integer, signed decimal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              f Floating point number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              o Integer, print as octal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              s Treat as C string (read all successive memory addresses until null character and print as characters)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              t Integer, print as binary (t=&quot;two&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              u Integer, unsigned decimal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              x Integer, print as hexadecimal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              i Instruction (read n assembly instructions from the specified memory address)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For a better explanation please follow through with the following example:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># A breakpoint has been set inside the program and the program has been run with the appropriate commands to reach the breakpoint.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># At this point we want to see which are the following 10 instructions.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) x/10i 0x80491cd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491cd &lt;main+4&gt;:  sub    esp,0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491d0 &lt;main+7&gt;:  mov    eax,ds:0x804c030</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491d5 &lt;main+12&gt;: push   0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491d7 &lt;main+14&gt;: push   0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491d9 &lt;main+16&gt;: push   0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491db &lt;main+18&gt;: push   eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491dc &lt;main+19&gt;: call   0x8049080 &lt;setvbuf@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Let&#x27;s examine the memory at 0x804a02a because we have a hint that this address holds one of the parameters of the scanf call  as it is afterwards placed on the stack (we&#x27;ll explain later how we have reached this conclusion).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The other parameter will be an address where the input will be stored.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) x/s 0x804a02a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x804a02a:      &quot;%d&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># We now set a breakpoint for *main+56.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) break *0x08049201</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Breakpoint 3 at 0x08049201</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) continue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Continuing.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Breakpoint 3, 0x08049201 in main ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># We then record the value of the eax register somewhere and use nexti(ni) and then we input an integer.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Let&#x27;s examine the address which we recorded earlier corresponding to the eax register (it should&#x27;ve held the address for the integer we input).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Take note that in GDB registers are preceded by the &quot;$&quot; character very much like variables.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) x/d 0xffffcf70 &lt;- (your address)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xffffcf70:     &lt;your input&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Now let&#x27;s print the contents of the eax register as hexadecimal.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) p/x $eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$1 = &lt;your input&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The diference between p and x can be observed by issuing the following commands:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x/s 0x804a030</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x804a030:      &quot;Your password is: %d. Evaluating it...\n&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p /s 0x804a030</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># $2 = 1920298841 which is the number in decimal format that &quot;Your&quot; can be translated to by its ascii codes (little endian so written as 0x72756F59).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># In order to see the same result we must use the command p /s (char*)0x804a030 and dereference the pointer ourselves.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># As you can see the address holds the memory for the beginning of the string.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This shows you how &quot;x&quot; interprets data from memory while &quot;p&quot; merely prints out the contents in the required format</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># You can think of it as &quot;x&quot; dereferencing while &quot;p&quot; not dereferencing</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gdb-command-file">GDB Command file<a class="hash-link" href="#gdb-command-file" title="Direct link to heading">​</a></h3><p>When exploiting, there are a couple of commands that you will issue periodically and doing that by hand will get cumbersome.
GDB commands files will allow you to run a specific set of commands automatically after each command you issue manually.
This comes in especially handy when you&#x27;re stepping through a program and want to see what happens with the registers and stack after each instruction is ran, which is the main target when exploiting.</p><p>The examine command only has sense when code is already running on the machine so inside the file we are going to use the display command which translates to the same output.</p><p>In order to use this option you must first create your commands file.
This file can include any GDB commands you like but a good start would be printing out the content of all the register values, the next ten instructions that are going to be executed, and some portion from the top of the stack.</p><p>The reason for examining all of the above after each instruction is ran will become more clear once the we go through the second section of the session.</p><p>Command file template:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display/10i $eip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">display/x $eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">display/x $ebx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">display/x $ecx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">display/x $edx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">display/x $edi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">display/x $esi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">display/x $ebp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">display/32xw $esp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In order to view all register values you could use the <code>x</code> command.
However the values of all registers can be obtained by running the<code>info all-registers</code> command:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(gdb) info all-registers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eax            0x8048630,134514224</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ecx            0xbffff404,-1073744892</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">edx            0xbffff394,-1073745004</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ebx            0xb7fc6ff4,-1208193036</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">esp            0xbffff330,0xbffff330</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ebp            0xbffff368,0xbffff368</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">esi            0x0,0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">edi            0x0,0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eip            0x80484e9,0x80484e9 &lt;main+37&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eflags         0x286,[ PF SF IF ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cs             0x73,115</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ss             0x7b,123</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ds             0x7b,123</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">es             0x7b,123</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fs             0x0,0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gs             0x33,51</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">st0            *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">st1            *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">st2            *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">st3            *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">st4            *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">st5            *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">st6            *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">st7            *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fctrl          0x37f,895</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fstat          0x0,0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ftag           0xffff,65535</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fiseg          0x0,0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fioff          0x0,0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foseg          0x0,0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fooff          0x0,0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fop            0x0,0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mxcsr          0x1f80,[ IM DM ZM OM UM PM ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ymm0           *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ymm1           *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ymm2           *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ymm3           *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ymm4           *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ymm5           *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ymm6           *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ymm7           *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mm0            *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mm1            *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mm2            *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mm3            *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mm4            *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mm5            *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mm6            *value not available*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mm7            *value not available*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>One thing you might notice while using GDB is that addresses seem to be pretty similar between runs.
Although with experience you will gain a better feel for where an address points to, one thing to remember at this point would be that stack addresses usually have the <code>0xbffff….</code> format.
In order to run GDB with the commands file you have just generated, when launching GDB specify the <code>-x [command_file]</code> parameter.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-gdb-to-modify-variables">Using GDB to modify variables<a class="hash-link" href="#using-gdb-to-modify-variables" title="Direct link to heading">​</a></h3><p>GDB can be used to modify variables during runtime.
In the case of exploitation this comes in handy as the program can be altered at runtime with the purpose of changing the execution path to desired branches.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pwndbg">Pwndbg<a class="hash-link" href="#pwndbg" title="Direct link to heading">​</a></h2><p>As you can see using GDB can be cumbersome, this is why we recommend using the Pwndbg plug-in.
The tutorial as well as the repository of the project can be found <a href="https://github.com/pwndbg/pwndbg" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Give the fact that Pwndbg is just a wrapper, all the functionality of GDB will be available when running gdb with the Pwndbg plug-in.
Some of the advantages of using pwngdb include:</p><ul><li>Automatic preview of registers, code and stack after each instruction (you no longer need to create your own commands file)</li><li>Automatic dereferencing and following through of memory locations</li><li>Color coding</li></ul><p>An alternative to Pwndbg is <a href="https://github.com/hugsy/gef" target="_blank" rel="noopener noreferrer">GEF</a>.
However, this tutorial is designed with Pwndbg in mind.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pwndbg-commands">Pwndbg Commands<a class="hash-link" href="#pwndbg-commands" title="Direct link to heading">​</a></h3><p><code>pdis</code> command gives a pretty output that is similar to what the <code>disas</code> command in GDB prints:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Usage:  pdis 0x80491d0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If <code>pdis</code> is used with an address as a parameter, the output will be similar to what <code>x/Ni</code> prints out (where N is the number of instructions you want to disassemble):</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Usage:  pdis [address] [N] - where N is the number of instructions you want to be printed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>stepi</code> command has the same effect as in GDB however, if you are running Pwndbg you will notice that after each step Pwndbg will automatically print register values, several lines of code from <code>eip</code>.
register and a portion of the stack:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; stepi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">────────────────────────────────────[ REGISTERS ]────────────────────────────────────</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*EAX  0xf7facd20 (_IO_2_1_stdout_) ◂— 0xfbad2084</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> EBX  0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ECX  0xa00af61b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> EDX  0xffffcfb4 ◂— 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> EDI  0xf7fac000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1e9d6c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ESI  0xf7fac000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1e9d6c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> EBP  0xffffcf78 ◂— 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ESP  0xffffcf70 —▸ 0xf7fac000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1e9d6c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*EIP  0x80491d5 (main+12) ◂— push   0 /* &#x27;j&#x27; */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">─────────────────────────────────────[ DISASM ]──────────────────────────────────────</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491d0 &lt;main+7&gt;     mov    eax, dword ptr [stdout@GLIBC_2.0] &lt;0x804c030&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ► 0x80491d5 &lt;main+12&gt;    push   0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491d7 &lt;main+14&gt;    push   1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491d9 &lt;main+16&gt;    push   0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491db &lt;main+18&gt;    push   eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491dc &lt;main+19&gt;    call   setvbuf@plt &lt;setvbuf@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491e1 &lt;main+24&gt;    add    esp, 0x10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491e4 &lt;main+27&gt;    mov    dword ptr [ebp - 8], 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491eb &lt;main+34&gt;    push   0x804a010</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491f0 &lt;main+39&gt;    call   puts@plt &lt;puts@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491f5 &lt;main+44&gt;    add    esp, 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">──────────────────────────────────[ SOURCE (CODE) ]──────────────────────────────────</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In file: /home/kali/Desktop/dokermaker/binary-internal/sessions/05-dynamic-analysis/activities/01-02-challenge-sppb/src/sppb.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    6   execve(&quot;/bin/sh&quot;, 0, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    7 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    9 int main()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   10 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ► 11   setvbuf(stdout, NULL, _IOLBF, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   12   int readValue = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   13</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   14   printf(&quot;Please provide password: \n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   15   scanf(&quot;%d&quot;, &amp;readValue);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">──────────────────────────────────────[ STACK ]──────────────────────────────────────</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00:0000│ esp 0xffffcf70 —▸ 0xf7fac000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1e9d6c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">01:0004│     0xffffcf74 ◂— 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">02:0008│ ebp 0xffffcf78 ◂— 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">03:000c│     0xffffcf7c —▸ 0xf7de0fd6 (__libc_start_main+262) ◂— add    esp, 0x10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">04:0010│     0xffffcf80 ◂— 0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">05:0014│     0xffffcf84 —▸ 0xffffd024 —▸ 0xffffd1d9 ◂— &#x27;/home/kali/Desktop/sppb&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">06:0018│     0xffffcf88 —▸ 0xffffd02c —▸ 0xffffd24d ◂— &#x27;COLORFGBG=15;0&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">07:001c│     0xffffcf8c —▸ 0xffffcfb4 ◂— 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">────────────────────────────────────[ BACKTRACE ]────────────────────────────────────</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ► f 0 0x80491d5 main+12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   f 1 0xf7de0fd6 __libc_start_main+262</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can always use the following commands to obtain context at any given moment inside the debug process:</p><ul><li><code>context reg</code></li><li><code>context code</code></li><li><code>context stack</code></li><li><code>context all</code></li></ul><p>One additional Pwndbg command which can be used to show values in registers is the <code>telescope</code> command.
The command does dereferencing of the pointer values until it gets to a value and prints out the entire trace.</p><p>The command can be used with both registers and memory addresses:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg$ telescope $esp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00:0000│ esp 0xffffcf70 —▸ 0xf7fac000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1e9d6c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">01:0004│     0xffffcf74 ◂— 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">02:0008│ ebp 0xffffcf78 ◂— 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">03:000c│     0xffffcf7c —▸ 0xf7de0fd6 (__libc_start_main+262) ◂— add    esp, 0x10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">04:0010│     0xffffcf80 ◂— 0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">05:0014│     0xffffcf84 —▸ 0xffffd024 —▸ 0xffffd1d9 ◂— &#x27;/home/kali/Desktop/sppb&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">06:0018│     0xffffcf88 —▸ 0xffffd02c —▸ 0xffffd24d ◂— &#x27;COLORFGBG=15;0&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">07:001c│     0xffffcf8c —▸ 0xffffcfb4 ◂— 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; telescope 0xffffcf84</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00:0000│  0xffffcf84 —▸ 0xffffd024 —▸ 0xffffd1d9 ◂— &#x27;/home/kali/Desktop/sppb&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">01:0004│  0xffffcf88 —▸ 0xffffd02c —▸ 0xffffd24d ◂— &#x27;COLORFGBG=15;0&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">02:0008│  0xffffcf8c —▸ 0xffffcfb4 ◂— 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">03:000c│  0xffffcf90 —▸ 0xffffcfc4 ◂— 0xe38ae80b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">04:0010│  0xffffcf94 —▸ 0xf7ffdb60 —▸ 0xf7ffdb00 —▸ 0xf7fc93e0 —▸ 0xf7ffd9a0 ◂— ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">05:0014│  0xffffcf98 —▸ 0xf7fc9410 —▸ 0x804832d ◂— &#x27;GLIBC_2.0&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">06:0018│  0xffffcf9c —▸ 0xf7fac000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1e9d6c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">07:001c│  0xffffcfa0 ◂— 0x1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In the example above, the memory address 0x8048630 was loaded into <code>EAX</code>.
That is why examining the register or the memory location gives the same output.</p><p>For more information on various Pwndbg commands you can always visit the help.
However you should also know the basics of using GDB as well.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="altering-variables-and-memory-with-pwndbg-and-gdb">Altering variables and memory with Pwndbg and GDB<a class="hash-link" href="#altering-variables-and-memory-with-pwndbg-and-gdb" title="Direct link to heading">​</a></h3><p>In addition to basic registers, GDB has a two extra variables which map onto some of the existing registers, as follows:</p><ul><li><code>$pc - $eip</code></li><li><code>$sp - $esp</code></li><li><code>$fp - $ebp</code></li></ul><p>In addition to these there are also two registers which can be used to view the processor state <code>$ps - processor status</code></p><p>Values of memory addresses and registers can be altered at execution time.
Because altering memory is a lot easier using Pwndbg we are going to use it throughout today&#x27;s session.</p><p>The easiest way of altering the execution flow of a program is editing the <code>$eflags</code> register just before jump instructions.</p><p>Using GDB the <code>$eflags</code> register can be easily modified:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; reg eflags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EFLAGS 0x282 [ cf pf af zf SF IF df of ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Set the ZF flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; set $eflags |= (1 &lt;&lt; 6)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Clear the ZF flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; set $eflags &amp;= ~(1 &lt;&lt; 6)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Notice that the flags that are set are printed in all-caps when the<code>reg eflags</code> command is issued.</p><p>The <code>set</code> command  (GDB native) can be used to modify values that reside inside memory.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; telescope 0x804a010</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00:0000│  0x804a010 ◂— &#x27;Please provide password: &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">01:0004│  0x804a014 ◂— &#x27;se provide password: &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">02:0008│  0x804a018 ◂— &#x27;rovide password: &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">03:000c│  0x804a01c ◂— &#x27;de password: &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">04:0010│  0x804a020 ◂— &#x27;assword: &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">05:0014│  0x804a024 ◂— &#x27;ord: &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">06:0018│  0x804a028 ◂— 0x64250020 /* &#x27; &#x27; */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">07:001c│  0x804a02c ◂— 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; set {char [14]} 0x804a010 = &quot;No pass here&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Written 28 bytes to 0x8048630</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; telescope 0x8048630</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00:0000│  0x804a010 ◂— &#x27;No pass here&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">01:0004│  0x804a014 ◂— &#x27;ass here&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">02:0008│  0x804a018 ◂— &#x27;here&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">03:000c│  0x804a01c ◂— 0x70200000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">04:0010│  0x804a020 ◂— &#x27;assword: &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">05:0014│  0x804a024 ◂— &#x27;ord: &#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">06:0018│  0x804a028 ◂— 0x64250020 /* &#x27; &#x27; */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">07:001c│  0x804a02c ◂— 0x0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As you can see the string residing in memory at address <code>0x8048630</code> has been modified using the <code>set</code> command.</p><p>Pwngdb does not offer enhancements in modifying registry values.
For modifying registry values you can use the GDB <code>set</code> command.</p><div class="language-{.code} codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-{.code} codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pwngdb&gt; p/x $eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$10 = 0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwngdb&gt; set $eax=0x80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwngdb&gt; p/x $eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$11 = 0x80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-stack">The Stack<a class="hash-link" href="#the-stack" title="Direct link to heading">​</a></h2><p>This section details process of function calling in detail.
Understanding function calling and stack operations during program execution is essential to exploitation.</p><p>The stack is one of the areas of memory which gets the biggest attention in exploitation writing.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="stack-growth">Stack Growth<a class="hash-link" href="#stack-growth" title="Direct link to heading">​</a></h3><p>The stack grows from high memory addresses to low memory addresses.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt;  pdis $eip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491db &lt;main+18&gt;    push   eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491dc &lt;main+19&gt;    call   setvbuf@plt &lt;setvbuf@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491e1 &lt;main+24&gt;    add    esp, 0x10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491e4 &lt;main+27&gt;    mov    dword ptr [ebp - 8], 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80491eb &lt;main+34&gt;    push   0x804a010</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ► 0x80491f0 &lt;main+39&gt;    call   puts@plt &lt;puts@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; p/x $esp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$1 = 0xffffcf6c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; si</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x8049050 in puts@plt ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; p/x $esp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$5 = 0xffffcf68</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As you can see from the example above the \$esp register had an initial value of <code>0xffffcf6c</code>.
The next instruction that is about to be executed is a push (it pushes <code>0x0</code> on the stack).
We execute the instruction and then reevaluate the value of <code>$esp</code>.
As we can see <code>$esp</code> now points to <code>0xffffcf68</code> (<code>0xffffcf6c-0x4</code>).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="frame-pointers-and-local-function-variables">Frame Pointers and Local Function Variables<a class="hash-link" href="#frame-pointers-and-local-function-variables" title="Direct link to heading">​</a></h3><p>Whenever the processor is entering the execution for a function, a special logical container is created on the stack for that function.</p><p>This container is called a function frame.
The idea behind it is that the processor must know which area of the stack belongs to which function.</p><p>In order to achieve this logical segmentation a set of 2 instructions are automatically inserted by the compiler at the beginning of each function.
Can you tell what they are based on the output below?</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; break main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Breakpoint 1 at 0x80484c8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[----------------------------------registers-----------------------------------]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> EAX  0xf7fa99e8 (environ) —▸ 0xffffd02c —▸ 0xffffd24d ◂— &#x27;COLORFGBG=15;0&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> EBX  0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ECX  0xb8a6a751</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> EDX  0xffffcfb4 ◂— 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> EDI  0x80490a0 (_start) ◂— xor    ebp, ebp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ESI  0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> EBP  0xffffcf78 ◂— 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ESP  0xffffcf70 ◂— 0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> EIP  0x80491d0 (main+7) ◂— mov    eax, dword ptr [0x804c030]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[-------------------------------------code-------------------------------------]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491c9 &lt;+0&gt;:     push   ebp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491ca &lt;+1&gt;:     mov    ebp,esp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491cc &lt;+3&gt;:     push   ebx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491cd &lt;+4&gt;:     sub    esp,0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=&gt; 0x080491d0 &lt;+7&gt;:     mov    eax,ds:0x804c030</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491d5 &lt;+12&gt;:    push   0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491d7 &lt;+14&gt;:    push   0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491d9 &lt;+16&gt;:    push   0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491db &lt;+18&gt;:    push   eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[------------------------------------stack-------------------------------------]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00:0000│ esp 0xffffcf70 ◂— 0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">01:0004│     0xffffcf74 ◂— 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">02:0008│ ebp 0xffffcf78 ◂— 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">03:000c│     0xffffcf7c —▸ 0xf7dda905 (__libc_start_main+229) ◂— add    esp, 0x10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">04:0010│     0xffffcf80 ◂— 0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">05:0014│     0xffffcf84 —▸ 0xffffd024 —▸ 0xffffd1d9 ◂— &#x27;/home/kali/Desktop/sppb&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">06:0018│     0xffffcf88 —▸ 0xffffd02c —▸ 0xffffd24d ◂— &#x27;COLORFGBG=15;0&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">07:001c│     0xffffcf8c —▸ 0xffffcfb4 ◂— 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[------------------------------------------------------------------------------]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Legend: code, data, rodata, value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Breakpoint 1, 0x080491d0 in main ()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt;  disass password_accepted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491b2 &lt;+0&gt;:     push   ebp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491b3 &lt;+1&gt;:     mov    ebp,esp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491b5 &lt;+3&gt;:     push   0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491b7 &lt;+5&gt;:     push   0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491b9 &lt;+7&gt;:     push   0x804a008</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491be &lt;+12&gt;:    call   0x8049070 &lt;execve@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491c3 &lt;+17&gt;:    add    esp,0xc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491c6 &lt;+20&gt;:    nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491c7 &lt;+21&gt;:    leave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080491c8 &lt;+22&gt;:    ret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>What we did is we created a breakpoint for the start of the main function and then ran the program.
As you can see the first 2 instructions that got executed were <code>push ebp</code> and <code>mov ebp,esp</code>.</p><p>We then set a breakpoint for another function called <code>pass_accepted</code>, continued execution and entered a password that we know is going to pass validation.
Once the breakpoint is hit, we can see the same 2 instructions <code>push ebp</code> and <code>mov ebp,esp</code>.</p><p>The two instructions which can be noticed at the beginning of any function are the instructions required for creating the logical container for each function on the stack.</p><p>In essence what they do is save the reference of the old container (<code>push ebp</code>) and record the current address at the top of the stack as the beginning of the new container(<code>mov ebp,esp</code>).</p><p>For a visual explanation please see below:</p><p><img loading="lazy" src="https://security.cs.pub.ro/summer-school/wiki/_media/session/s5_frame_pointer_picture.jpg" alt="Frame pointer" class="img_ev3q"></p><p>As you can see the <code>EBP</code> register always points to the stack address that corresponds to the beginning of the current function&#x27;s frame.
That is why it is most often referred to as the frame pointer.</p><p>In addition to the two instructions required for creating a new stack frame for a function, there are a couple more instructions that you will usually see at the beginning of a function</p><p>If you analyze the instructions at the beginning of main, you can spot these as being:</p><ul><li><p>An <code>and esp,0xfffffff0</code> instruction.</p></li><li><p>A <code>sub</code> instruction that subtracts a hex value from ESP.</p></li></ul><p>The first of the two instructions has the purpose of aligning the stack to a specific address boundary.
This is done to increase processor efficiency.
In our specific case, the top of the stack gets aligned to a 16 byte multiple address.</p><p>One of the purposes of the stack inside functions is that of offering address space in which to place local variables.
The second instruction preallocates space for local function variables.</p><p>Let&#x27;s see how local variables are handled inside assembly code.</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        a</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kali@kali:~/sss$ gdb test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GNU gdb (Ubuntu/Linaro 7.4-2012.02-0ubuntu2) 7.4-2012.02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Copyright (C) 2012 Free Software Foundation, Inc.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This is free software: you are free to change and redistribute it.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">There is NO WARRANTY, to the extent permitted by law.  Type &quot;show copying&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">and &quot;show warranty&quot; for details.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This GDB was configured as &quot;i686-linux-gnu&quot;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">For bug reporting instructions, please see:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;http://bugs.launchpad.net/gdb-linaro/&gt;...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Reading symbols from /home/dgioga/sss/test...(no debugging symbols found)...done.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt;  break main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Breakpoint 1 at 0x80483ba</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt;  run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[----------------------------------registers-----------------------------------]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EAX: 0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EBX: 0xb7fc6ff4 --&gt; 0x1a0d7c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ECX: 0xbffff414 --&gt; 0xbffff576 (&quot;/home/dgioga/sss/test&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EDX: 0xbffff3a4 --&gt; 0xb7fc6ff4 --&gt; 0x1a0d7c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ESI: 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EDI: 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EBP: 0xbffff378 --&gt; 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ESP: 0xbffff368 --&gt; 0x80483d9 (&lt;__libc_csu_init+9&gt;:,add    ebx,0x1c1b)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EIP: 0x80483ba (&lt;main+6&gt;:,mov    DWORD PTR [ebp-0x4],0x1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EFLAGS: 0x200282 (carry parity adjust zero SIGN trap INTERRUPT direction overflow)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[-------------------------------------code-------------------------------------]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80483b4 &lt;main&gt;:,  push   ebp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80483b5 &lt;main+1&gt;:,mov    ebp,esp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80483b7 &lt;main+3&gt;:,sub    esp,0x10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=&gt; 0x80483ba &lt;main+6&gt;:,mov    DWORD PTR [ebp-0x4],0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80483c1 &lt;main+13&gt;:,mov    eax,0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80483c6 &lt;main+18&gt;:,leave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80483c7 &lt;main+19&gt;:,ret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x80483c8:,nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[------------------------------------stack-------------------------------------]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000| 0xbffff368 --&gt; 0x80483d9 (&lt;__libc_csu_init+9&gt;:,add    ebx,0x1c1b)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0004| 0xbffff36c --&gt; 0xb7fc6ff4 --&gt; 0x1a0d7c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0008| 0xbffff370 --&gt; 0x80483d0 (&lt;__libc_csu_init&gt;:,push   ebp)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0012| 0xbffff374 --&gt; 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0016| 0xbffff378 --&gt; 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0020| 0xbffff37c --&gt; 0xb7e3f4d3 (&lt;__libc_start_main+243&gt;:,mov    DWORD PTR [esp],eax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0024| 0xbffff380 --&gt; 0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0028| 0xbffff384 --&gt; 0xbffff414 --&gt; 0xbffff576 (&quot;/home/dgioga/sss/test&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[------------------------------------------------------------------------------]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Legend: code, data, rodata, value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Breakpoint 1, 0x080483ba in main ()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As you can see the operations that relate to the stack are:</p><ul><li>The old frame pointer is saved.</li><li><code>EBP</code> takes the value of ESP (the frame pointer is set to point to the current function&#x27;s frame).</li><li><code>0x10</code> is subtracted from ESP (reserve space for local variables).</li><li>The value <code>0x01</code> is placed at the address of <code>EBP-0x4</code> (the local variable <code>a</code> takes the value 1).</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="function-parameters">Function Parameters<a class="hash-link" href="#function-parameters" title="Direct link to heading">​</a></h3><p>The stack is also used to pass in parameters to functions.</p><p>In the process of calling a function we can define two entities.
The callee (the function that gets called) and the caller (the function that calls).</p><p>When a function is called, the caller pushes the parameters for the callee on the stack.
The parameters are pushed in reverse order.</p><p>When the callee wants to get access to the parameters it was called with, all it needs to do is access the area of the stack that is higher up in reference to the start of it&#x27;s frame.</p><p>At this point it makes sense to remember the following cases:</p><ul><li>When <code>EBP+value</code> is referred to it is generally a referral to a parameter passed in to the current function.</li><li>When <code>EBP-value</code> is referred to it is generally a referral to a local variable.</li></ul><p>Lets see how this happens with the following code:</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> c</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">a</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> c</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; pdis 0x080483ca</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dump of assembler code for function main:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483ca &lt;+0&gt;:,push   ebp                        #save the old frame pointer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483cb &lt;+1&gt;:,mov    ebp,esp                    #create the new frame pointer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483cd &lt;+3&gt;:,sub    esp,0x8                    #create space for local variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483d0 &lt;+6&gt;:,mov    DWORD PTR [esp+0x4],0x3    #push the last parameter of the function that is to be called</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483d8 &lt;+14&gt;:,mov    DWORD PTR [esp],0xa      #push the second to last(the first in this case) parameter of the function that is to be called</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483df &lt;+21&gt;:,call   0x80483b4 &lt;add&gt;          #call the function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483e4 &lt;+26&gt;:,mov    eax,0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483e9 &lt;+31&gt;:,leave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483ea &lt;+32&gt;:,ret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End of assembler dump.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwndbg&gt; pdis 0x080483b4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dump of assembler code for function add:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483b4 &lt;+0&gt;:,push   ebp                        #save the old frame pointer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483b5 &lt;+1&gt;:,mov    ebp,esp                    #create a new frame pointer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483b7 &lt;+3&gt;:,sub    esp,0x10                   #create space for local variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483ba &lt;+6&gt;:,mov    eax,DWORD PTR [ebp+0xc]    #move the first parameter into the EAX register (ebp+saved_ebp(4 bytes)+return_addres(4 bytes)+last_parameter(4 bytes))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483bd &lt;+9&gt;:,mov    edx,DWORD PTR [ebp+0x8]    #move the second parameter into the EDX register (ebp+saved_ebp(4 bytes)+return_addres(4 bytes))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483c0 &lt;+12&gt;:,add    eax,edx                  #add the registers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483c2 &lt;+14&gt;:,mov    DWORD PTR [ebp-0x4],eax  #place the result inside the local variable (c)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483c5 &lt;+17&gt;:,mov    eax,DWORD PTR [ebp-0x4]  #place the result inside the eax register in order to return it</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483c8 &lt;+20&gt;:,leave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080483c9 &lt;+21&gt;:,ret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End of assembler dump.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As you can see the parameters were pushed in reverse order, and the rule regarding the reference to <code>EBP</code> holds.</p><p>If you don&#x27;t understand why the offset for the parameters starts at <code>EBP+0x08</code> and not <code>EBP</code> follow through with the next section.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="calling-functions-call-and-ret">Calling Functions (<code>call</code> and <code>ret</code>)<a class="hash-link" href="#calling-functions-call-and-ret" title="Direct link to heading">​</a></h3><p>When calling a function the callee places the return address on the stack.
This address is nothing more than a bookmark so that execution can resume where it left off once the called function finishes execution.</p><p>The last instruction in functions is usually a <code>ret</code> instruction that resumes execution to the callee.</p><p>For a better understanding of function calling and returning, from an execution flow point of view, please follow through with the following tip.</p><p>The call instruction could be translated to the following instructions:</p><ul><li><code>push eip</code></li><li><code>mov eip, address_of_called_function</code></li></ul><p>The <code>ret</code> instruction could be translated into <code>pop eip</code>.</p><p>The visual depiction of how the stack looks while a program is executing can be found in section 2 but will be included here as well:</p><p><img loading="lazy" src="https://security.cs.pub.ro/summer-school/wiki/_media/session/stack-convention.png" alt="Stack Convention" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="next-section-preview-buffer-overflows">Next Section Preview: Buffer Overflows<a class="hash-link" href="#next-section-preview-buffer-overflows" title="Direct link to heading">​</a></h3><p>Now that we have a complete overview of the stack we can step forward to stack based buffer overflows.</p><p>A buffer overflow takes place when there is a lack of checking regarding boundaries and usually result in complete control of the program&#x27;s instruction pointer.
This takes place when a buffer overflows its boundaries and overwrites the return address of a function.</p><p>A typical example of buffer overflows can be seen in the following picture:</p><p><img loading="lazy" src="https://security.cs.pub.ro/summer-school/wiki/_media/session/s5_buffer_overflow.jpg" alt="Buffer Overflow" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="challenges">Challenges<a class="hash-link" href="#challenges" title="Direct link to heading">​</a></h2><p>Use GDB and Pwndbg to run the code provided in the Activities section.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="01-challenge---explore-the-simple-password-protected-bash">01. Challenge - Explore The Simple Password Protected Bash<a class="hash-link" href="#01-challenge---explore-the-simple-password-protected-bash" title="Direct link to heading">​</a></h3><p>The executable gets input from the user and evaluates it against a static condition.
If it succeeds it then calls a <code>password_accepted</code> function that prints out a success message and spawns a shell.</p><p>Your task is to use GDB and Pwndbg to force the executable to call the <code>password_accepted</code> function.</p><p>Gather as much info about the executable as possible through the techniques you have learned in previous sessions.</p><p>Think of modifying registers for forcing the executable to call the function (there is more than one way of doing this).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="02-challenge---simple-password-protected-bash-destruction">02. Challenge - Simple Password Protected Bash Destruction<a class="hash-link" href="#02-challenge---simple-password-protected-bash-destruction" title="Direct link to heading">​</a></h3><p>What is the condition against which your input is evaluated in the executable contained in the executable <code>sppb</code>?</p><p>The ultimate goal is to be able to craft an input for the binary so that the <code>password_accepted</code> function is called (modifying registers while running the program in GDB is just for training purposes).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="03-challenge---domino">03. Challenge - Domino<a class="hash-link" href="#03-challenge---domino" title="Direct link to heading">​</a></h3><p>Analyze the binary, reverse engineer what it does and get a nice message
back.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="04-challenge---call-me">04. Challenge - Call Me<a class="hash-link" href="#04-challenge---call-me" title="Direct link to heading">​</a></h3><p>Investigate the binary in <code>04-challenge-call-me/src/call_me</code> and find out the flag</p><p>Hint: There is something hidden you can toy around with.</p><p>Hint: The challenge name is a hint.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="05-challenge---snooze-me">05. Challenge - Snooze Me<a class="hash-link" href="#05-challenge---snooze-me" title="Direct link to heading">​</a></h3><p>I wrote a simple binary that computes the answer to life, the universe and everything.
It swear it works... eventually.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="06-challenge---phone-home">06. Challenge - Phone Home<a class="hash-link" href="#06-challenge---phone-home" title="Direct link to heading">​</a></h3><p>To protect their confidential data from those snooping cloud providers, the authors of <code>06-challenge-phone-home/src/phone_home</code> have used some obfuscation techniques.</p><p>Unfortunately, the key feature of the application is now unreachable due to a bug.
Can you bypass the impossible condition?</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="07-challenge---chain-encoder">07. Challenge - Chain Encoder<a class="hash-link" href="#07-challenge---chain-encoder" title="Direct link to heading">​</a></h3><p>How do you reverse something made to be irreversible, you are welcome to find out in this challenge.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="08-challenge---simple-cd-key">08. Challenge - Simple CD Key<a class="hash-link" href="#08-challenge---simple-cd-key" title="Direct link to heading">​</a></h3><p>I found this software but i don&#x27;t have the CD key, can you crack it for me?</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/binary-security/Binary Analysis/Dynamic Analysis/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Dynamic Analysis</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/binary-security/Binary Analysis/Dynamic Analysis/Dynamic-Analysis"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Dynamic-Analysis</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a><ul><li><a href="#objectives--rationale" class="table-of-contents__link toc-highlight">Objectives &amp; Rationale</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#before-gdb" class="table-of-contents__link toc-highlight">Before GDB</a></li></ul></li><li><a href="#gdb-basic-commands" class="table-of-contents__link toc-highlight">GDB Basic Commands</a><ul><li><a href="#getting-help-with-gdb" class="table-of-contents__link toc-highlight">Getting help with GDB</a></li><li><a href="#opening-a-program-with-gdb" class="table-of-contents__link toc-highlight">Opening a program with GDB</a></li><li><a href="#disassembling" class="table-of-contents__link toc-highlight">Disassembling</a></li><li><a href="#adding-breakpoints" class="table-of-contents__link toc-highlight">Adding Breakpoints</a></li><li><a href="#listing-breakpoints" class="table-of-contents__link toc-highlight">Listing Breakpoints</a></li><li><a href="#deleting-breakpoints" class="table-of-contents__link toc-highlight">Deleting Breakpoints</a></li><li><a href="#examine-and-print-your-most-powerful-tools" class="table-of-contents__link toc-highlight">Examine and Print, Your Most Powerful Tools</a></li><li><a href="#gdb-command-file" class="table-of-contents__link toc-highlight">GDB Command file</a></li><li><a href="#using-gdb-to-modify-variables" class="table-of-contents__link toc-highlight">Using GDB to modify variables</a></li></ul></li><li><a href="#pwndbg" class="table-of-contents__link toc-highlight">Pwndbg</a><ul><li><a href="#pwndbg-commands" class="table-of-contents__link toc-highlight">Pwndbg Commands</a></li><li><a href="#altering-variables-and-memory-with-pwndbg-and-gdb" class="table-of-contents__link toc-highlight">Altering variables and memory with Pwndbg and GDB</a></li></ul></li><li><a href="#the-stack" class="table-of-contents__link toc-highlight">The Stack</a><ul><li><a href="#stack-growth" class="table-of-contents__link toc-highlight">Stack Growth</a></li><li><a href="#frame-pointers-and-local-function-variables" class="table-of-contents__link toc-highlight">Frame Pointers and Local Function Variables</a></li><li><a href="#function-parameters" class="table-of-contents__link toc-highlight">Function Parameters</a></li><li><a href="#calling-functions-call-and-ret" class="table-of-contents__link toc-highlight">Calling Functions (<code>call</code> and <code>ret</code>)</a></li><li><a href="#next-section-preview-buffer-overflows" class="table-of-contents__link toc-highlight">Next Section Preview: Buffer Overflows</a></li></ul></li><li><a href="#challenges" class="table-of-contents__link toc-highlight">Challenges</a><ul><li><a href="#01-challenge---explore-the-simple-password-protected-bash" class="table-of-contents__link toc-highlight">01. Challenge - Explore The Simple Password Protected Bash</a></li><li><a href="#02-challenge---simple-password-protected-bash-destruction" class="table-of-contents__link toc-highlight">02. Challenge - Simple Password Protected Bash Destruction</a></li><li><a href="#03-challenge---domino" class="table-of-contents__link toc-highlight">03. Challenge - Domino</a></li><li><a href="#04-challenge---call-me" class="table-of-contents__link toc-highlight">04. Challenge - Call Me</a></li><li><a href="#05-challenge---snooze-me" class="table-of-contents__link toc-highlight">05. Challenge - Snooze Me</a></li><li><a href="#06-challenge---phone-home" class="table-of-contents__link toc-highlight">06. Challenge - Phone Home</a></li><li><a href="#07-challenge---chain-encoder" class="table-of-contents__link toc-highlight">07. Challenge - Chain Encoder</a></li><li><a href="#08-challenge---simple-cd-key" class="table-of-contents__link toc-highlight">08. Challenge - Simple CD Key</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://security-summer-school.github.io/binary/" target="_blank" rel="noopener noreferrer" class="footer__link-item">site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/SSSUPB/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 SSS Team</div></div></div></footer></div>
<script src="/binary-security/assets/js/runtime~main.2a371c1c.js"></script>
<script src="/binary-security/assets/js/main.a3ed9e3a.js"></script>
</body>
</html>